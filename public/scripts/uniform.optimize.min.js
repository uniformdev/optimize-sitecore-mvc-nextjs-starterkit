!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).uniformdev=e()}}((function(){return function e(t,i,r){function n(a,s){if(!i[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var d=i[a]={exports:{}};t[a][0].call(d.exports,(function(e){return n(t[a][1][e]||e)}),d,d.exports,e,t,i,r)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(e,t,i){t.exports=e("./lib/axios")},{"./lib/axios":3}],2:[function(e,t,i){"use strict";var r=e("./../utils"),n=e("./../core/settle"),o=e("./../helpers/cookies"),a=e("./../helpers/buildURL"),s=e("../core/buildFullPath"),c=e("./../helpers/parseHeaders"),u=e("./../helpers/isURLSameOrigin"),d=e("../core/createError");t.exports=function(e){return new Promise((function(t,i){var l=e.data,f=e.headers;r.isFormData(l)&&delete f["Content-Type"];var v=new XMLHttpRequest;if(e.auth){var g=e.auth.username||"",p=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";f.Authorization="Basic "+btoa(g+":"+p)}var h=s(e.baseURL,e.url);if(v.open(e.method.toUpperCase(),a(h,e.params,e.paramsSerializer),!0),v.timeout=e.timeout,v.onreadystatechange=function(){if(v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in v?c(v.getAllResponseHeaders()):null,o={data:e.responseType&&"text"!==e.responseType?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:r,config:e,request:v};n(t,i,o),v=null}},v.onabort=function(){v&&(i(d("Request aborted",e,"ECONNABORTED",v)),v=null)},v.onerror=function(){i(d("Network Error",e,null,v)),v=null},v.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),i(d(t,e,"ECONNABORTED",v)),v=null},r.isStandardBrowserEnv()){var m=(e.withCredentials||u(h))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;m&&(f[e.xsrfHeaderName]=m)}if("setRequestHeader"in v&&r.forEach(f,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete f[t]:v.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(v.withCredentials=!!e.withCredentials),e.responseType)try{v.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&v.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){v&&(v.abort(),i(e),v=null)})),l||(l=null),v.send(l)}))}},{"../core/buildFullPath":9,"../core/createError":10,"./../core/settle":14,"./../helpers/buildURL":18,"./../helpers/cookies":20,"./../helpers/isURLSameOrigin":23,"./../helpers/parseHeaders":25,"./../utils":27}],3:[function(e,t,i){"use strict";var r=e("./utils"),n=e("./helpers/bind"),o=e("./core/Axios"),a=e("./core/mergeConfig");function s(e){var t=new o(e),i=n(o.prototype.request,t);return r.extend(i,o.prototype,t),r.extend(i,t),i}var c=s(e("./defaults"));c.Axios=o,c.create=function(e){return s(a(c.defaults,e))},c.Cancel=e("./cancel/Cancel"),c.CancelToken=e("./cancel/CancelToken"),c.isCancel=e("./cancel/isCancel"),c.all=function(e){return Promise.all(e)},c.spread=e("./helpers/spread"),c.isAxiosError=e("./helpers/isAxiosError"),t.exports=c,t.exports.default=c},{"./cancel/Cancel":4,"./cancel/CancelToken":5,"./cancel/isCancel":6,"./core/Axios":7,"./core/mergeConfig":13,"./defaults":16,"./helpers/bind":17,"./helpers/isAxiosError":22,"./helpers/spread":26,"./utils":27}],4:[function(e,t,i){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},{}],5:[function(e,t,i){"use strict";var r=e("./Cancel");function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var i=this;e((function(e){i.reason||(i.reason=new r(e),t(i.reason))}))}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e;return{token:new n((function(t){e=t})),cancel:e}},t.exports=n},{"./Cancel":4}],6:[function(e,t,i){"use strict";t.exports=function(e){return!(!e||!e.__CANCEL__)}},{}],7:[function(e,t,i){"use strict";var r=e("./../utils"),n=e("../helpers/buildURL"),o=e("./InterceptorManager"),a=e("./dispatchRequest"),s=e("./mergeConfig");function c(e){this.defaults=e,this.interceptors={request:new o,response:new o}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],i=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)i=i.then(t.shift(),t.shift());return i},c.prototype.getUri=function(e){return e=s(this.defaults,e),n(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,i){return this.request(s(i||{},{method:e,url:t,data:(i||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,i,r){return this.request(s(r||{},{method:e,url:t,data:i}))}})),t.exports=c},{"../helpers/buildURL":18,"./../utils":27,"./InterceptorManager":8,"./dispatchRequest":11,"./mergeConfig":13}],8:[function(e,t,i){"use strict";var r=e("./../utils");function n(){this.handlers=[]}n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},t.exports=n},{"./../utils":27}],9:[function(e,t,i){"use strict";var r=e("../helpers/isAbsoluteURL"),n=e("../helpers/combineURLs");t.exports=function(e,t){return e&&!r(t)?n(e,t):t}},{"../helpers/combineURLs":19,"../helpers/isAbsoluteURL":21}],10:[function(e,t,i){"use strict";var r=e("./enhanceError");t.exports=function(e,t,i,n,o){var a=new Error(e);return r(a,t,i,n,o)}},{"./enhanceError":12}],11:[function(e,t,i){"use strict";var r=e("./../utils"),n=e("./transformData"),o=e("../cancel/isCancel"),a=e("../defaults");function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}t.exports=function(e){return s(e),e.headers=e.headers||{},e.data=n(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return s(e),t.data=n(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(s(e),t&&t.response&&(t.response.data=n(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},{"../cancel/isCancel":6,"../defaults":16,"./../utils":27,"./transformData":15}],12:[function(e,t,i){"use strict";t.exports=function(e,t,i,r,n){return e.config=t,i&&(e.code=i),e.request=r,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},{}],13:[function(e,t,i){"use strict";var r=e("../utils");t.exports=function(e,t){t=t||{};var i={},n=["url","method","data"],o=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function c(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function u(n){r.isUndefined(t[n])?r.isUndefined(e[n])||(i[n]=c(void 0,e[n])):i[n]=c(e[n],t[n])}r.forEach(n,(function(e){r.isUndefined(t[e])||(i[e]=c(void 0,t[e]))})),r.forEach(o,u),r.forEach(a,(function(n){r.isUndefined(t[n])?r.isUndefined(e[n])||(i[n]=c(void 0,e[n])):i[n]=c(void 0,t[n])})),r.forEach(s,(function(r){r in t?i[r]=c(e[r],t[r]):r in e&&(i[r]=c(void 0,e[r]))}));var d=n.concat(o).concat(a).concat(s),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return r.forEach(l,u),i}},{"../utils":27}],14:[function(e,t,i){"use strict";var r=e("./createError");t.exports=function(e,t,i){var n=i.config.validateStatus;i.status&&n&&!n(i.status)?t(r("Request failed with status code "+i.status,i.config,null,i.request,i)):e(i)}},{"./createError":10}],15:[function(e,t,i){"use strict";var r=e("./../utils");t.exports=function(e,t,i){return r.forEach(i,(function(i){e=i(e,t)})),e}},{"./../utils":27}],16:[function(e,t,i){(function(i){(function(){"use strict";var r=e("./utils"),n=e("./helpers/normalizeHeaderName"),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,c={adapter:("undefined"!=typeof XMLHttpRequest?s=e("./adapters/xhr"):void 0!==i&&"[object process]"===Object.prototype.toString.call(i)&&(s=e("./adapters/http")),s),transformRequest:[function(e,t){return n(t,"Accept"),n(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(o)})),t.exports=c}).call(this)}).call(this,e("_process"))},{"./adapters/http":2,"./adapters/xhr":2,"./helpers/normalizeHeaderName":24,"./utils":27,_process:31}],17:[function(e,t,i){"use strict";t.exports=function(e,t){return function(){for(var i=new Array(arguments.length),r=0;r<i.length;r++)i[r]=arguments[r];return e.apply(t,i)}}},{}],18:[function(e,t,i){"use strict";var r=e("./../utils");function n(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(e,t,i){if(!t)return e;var o;if(i)o=i(t);else if(r.isURLSearchParams(t))o=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(n(t)+"="+n(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},{"./../utils":27}],19:[function(e,t,i){"use strict";t.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},{}],20:[function(e,t,i){"use strict";var r=e("./../utils");t.exports=r.isStandardBrowserEnv()?{write:function(e,t,i,n,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(i)&&s.push("expires="+new Date(i).toGMTString()),r.isString(n)&&s.push("path="+n),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},{"./../utils":27}],21:[function(e,t,i){"use strict";t.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},{}],22:[function(e,t,i){"use strict";t.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},{}],23:[function(e,t,i){"use strict";var r=e("./../utils");t.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function n(e){var r=e;return t&&(i.setAttribute("href",r),r=i.href),i.setAttribute("href",r),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return e=n(window.location.href),function(t){var i=r.isString(t)?n(t):t;return i.protocol===e.protocol&&i.host===e.host}}():function(){return!0}},{"./../utils":27}],24:[function(e,t,i){"use strict";var r=e("../utils");t.exports=function(e,t){r.forEach(e,(function(i,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=i,delete e[r])}))}},{"../utils":27}],25:[function(e,t,i){"use strict";var r=e("./../utils"),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(e){var t,i,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),i=r.trim(e.substr(o+1)),t){if(a[t]&&n.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([i]):a[t]?a[t]+", "+i:i}})),a):a}},{"./../utils":27}],26:[function(e,t,i){"use strict";t.exports=function(e){return function(t){return e.apply(null,t)}}},{}],27:[function(e,t,i){"use strict";var r=e("./helpers/bind"),n=Object.prototype.toString;function o(e){return"[object Array]"===n.call(e)}function a(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==n.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===n.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var i=0,r=e.length;i<r;i++)t.call(null,e[i],i,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}t.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===n.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isPlainObject:c,isUndefined:a,isDate:function(e){return"[object Date]"===n.call(e)},isFile:function(e){return"[object File]"===n.call(e)},isBlob:function(e){return"[object Blob]"===n.call(e)},isFunction:u,isStream:function(e){return s(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:d,merge:function e(){var t={};function i(i,r){c(t[r])&&c(i)?t[r]=e(t[r],i):c(i)?t[r]=e({},i):o(i)?t[r]=i.slice():t[r]=i}for(var r=0,n=arguments.length;r<n;r++)d(arguments[r],i);return t},extend:function(e,t,i){return d(t,(function(t,n){e[n]=i&&"function"==typeof t?r(t,i):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},{"./helpers/bind":17}],28:[function(e,t,i){(function(r,n){(function(){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
!function(e,r){"object"==typeof i&&void 0!==t?t.exports=r():e.ES6Promise=r()}(this,(function(){"use strict";function t(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,a=void 0,s=void 0,c=function(e,t){p[o]=e,p[o+1]=t,2===(o+=2)&&(s?s(h):w())};var u="undefined"!=typeof window?window:void 0,d=u||{},l=d.MutationObserver||d.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==r&&"[object process]"==={}.toString.call(r),v="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function g(){var e=setTimeout;return function(){return e(h,1)}}var p=new Array(1e3);function h(){for(var e=0;e<o;e+=2){(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0}o=0}var m,y,b,k,w=void 0;function _(e,t){var i=this,r=new this.constructor(x);void 0===r[T]&&M(r);var n=i._state;if(n){var o=arguments[n-1];c((function(){return j(n,r,o,i._result)}))}else N(i,r,e,t);return r}function O(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(x);return C(t,e),t}f?w=function(){return r.nextTick(h)}:l?(y=0,b=new l(h),k=document.createTextNode(""),b.observe(k,{characterData:!0}),w=function(){k.data=y=++y%2}):v?((m=new MessageChannel).port1.onmessage=h,w=function(){return m.port2.postMessage(0)}):w=void 0===u&&"function"==typeof e?function(){try{var e=Function("return this")().require("vertx");return void 0!==(a=e.runOnLoop||e.runOnContext)?function(){a(h)}:g()}catch(e){return g()}}():g();var T=Math.random().toString(36).substring(2);function x(){}var D=void 0;function E(e,i,r){i.constructor===e.constructor&&r===_&&i.constructor.resolve===O?function(e,t){1===t._state?S(e,t._result):2===t._state?A(e,t._result):N(t,void 0,(function(t){return C(e,t)}),(function(t){return A(e,t)}))}(e,i):void 0===r?S(e,i):t(r)?function(e,t,i){c((function(e){var r=!1,n=function(e,t,i,r){try{e.call(t,i,r)}catch(e){return e}}(i,t,(function(i){r||(r=!0,t!==i?C(e,i):S(e,i))}),(function(t){r||(r=!0,A(e,t))}),e._label);!r&&n&&(r=!0,A(e,n))}),e)}(e,i,r):S(e,i)}function C(e,t){if(e===t)A(e,new TypeError("You cannot resolve a promise with itself"));else if(n=typeof(r=t),null===r||"object"!==n&&"function"!==n)S(e,t);else{var i=void 0;try{i=t.then}catch(t){return void A(e,t)}E(e,t,i)}var r,n}function P(e){e._onerror&&e._onerror(e._result),U(e)}function S(e,t){e._state===D&&(e._result=t,e._state=1,0!==e._subscribers.length&&c(U,e))}function A(e,t){e._state===D&&(e._state=2,e._result=t,c(P,e))}function N(e,t,i,r){var n=e._subscribers,o=n.length;e._onerror=null,n[o]=t,n[o+1]=i,n[o+2]=r,0===o&&e._state&&c(U,e)}function U(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var r=void 0,n=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],n=t[a+i],r?j(i,r,n,o):n(o);e._subscribers.length=0}}function j(e,i,r,n){var o=t(r),a=void 0,s=void 0,c=!0;if(o){try{a=r(n)}catch(e){c=!1,s=e}if(i===a)return void A(i,new TypeError("A promises callback cannot return that same promise."))}else a=n;i._state!==D||(o&&c?C(i,a):!1===c?A(i,s):1===e?S(i,a):2===e&&A(i,a))}var R=0;function M(e){e[T]=R++,e._state=void 0,e._result=void 0,e._subscribers=[]}var I=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(x),this.promise[T]||M(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&S(this.promise,this._result))):A(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===D&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var i=this._instanceConstructor,r=i.resolve;if(r===O){var n=void 0,o=void 0,a=!1;try{n=e.then}catch(e){a=!0,o=e}if(n===_&&e._state!==D)this._settledAt(e._state,t,e._result);else if("function"!=typeof n)this._remaining--,this._result[t]=e;else if(i===V){var s=new i(x);a?A(s,o):E(s,e,n),this._willSettleAt(s,t)}else this._willSettleAt(new i((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,i){var r=this.promise;r._state===D&&(this._remaining--,2===e?A(r,i):this._result[t]=i),0===this._remaining&&S(r,this._result)},e.prototype._willSettleAt=function(e,t){var i=this;N(e,void 0,(function(e){return i._settledAt(1,t,e)}),(function(e){return i._settledAt(2,t,e)}))},e}();var V=function(){function e(t){this[T]=R++,this._result=this._state=void 0,this._subscribers=[],x!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t((function(t){C(e,t)}),(function(t){A(e,t)}))}catch(t){A(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var i=this,r=i.constructor;return t(e)?i.then((function(t){return r.resolve(e()).then((function(){return t}))}),(function(t){return r.resolve(e()).then((function(){throw t}))})):i.then(e,e)},e}();return V.prototype.then=_,V.all=function(e){return new I(this,e).promise},V.race=function(e){var t=this;return i(e)?new t((function(i,r){for(var n=e.length,o=0;o<n;o++)t.resolve(e[o]).then(i,r)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},V.resolve=O,V.reject=function(e){var t=new this(x);return A(t,e),t},V._setScheduler=function(e){s=e},V._setAsap=function(e){c=e},V._asap=c,V.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var i=null;try{i=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===i&&!t.cast)return}e.Promise=V},V.Promise=V,V}))}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:31}],29:[function(e,t,i){"use strict";function r(e){return Number.isInteger(e)&&e>=0}function n(e){this.name="ArgumentError",this.message=e}e("es6-promise").polyfill(),t.exports=function(e,t){if(t=t||{},"function"!=typeof e)throw new n("fetch must be a function");if("object"!=typeof t)throw new n("defaults must be an object");if(void 0!==t.retries&&!r(t.retries))throw new n("retries must be a positive integer");if(void 0!==t.retryDelay&&!r(t.retryDelay)&&"function"!=typeof t.retryDelay)throw new n("retryDelay must be a positive integer or a function returning a positive integer");if(void 0!==t.retryOn&&!Array.isArray(t.retryOn)&&"function"!=typeof t.retryOn)throw new n("retryOn property expects an array or function");return t=Object.assign({retries:3,retryDelay:1e3,retryOn:[]},t),function(i,o){var a=t.retries,s=t.retryDelay,c=t.retryOn;if(o&&void 0!==o.retries){if(!r(o.retries))throw new n("retries must be a positive integer");a=o.retries}if(o&&void 0!==o.retryDelay){if(!r(o.retryDelay)&&"function"!=typeof o.retryDelay)throw new n("retryDelay must be a positive integer or a function returning a positive integer");s=o.retryDelay}if(o&&o.retryOn){if(!Array.isArray(o.retryOn)&&"function"!=typeof o.retryOn)throw new n("retryOn property expects an array or function");c=o.retryOn}return new Promise((function(t,r){var n=function(n){e(i,o).then((function(e){Array.isArray(c)&&-1===c.indexOf(e.status)?t(e):"function"==typeof c?c(n,null,e)?u(n,null,e):t(e):n<a?u(n,null,e):t(e)})).catch((function(e){"function"==typeof c?c(n,e,null)?u(n,e,null):r(e):n<a?u(n,e,null):r(e)}))};function u(e,t,i){var r="function"==typeof s?s(e,t,i):s;setTimeout((function(){n(++e)}),r)}n(0)}))}}},{"es6-promise":28}],30:[function(e,t,i){!function(e,i){"use strict";"object"==typeof t&&t.exports?t.exports=i():e.log=i()}(this,(function(){"use strict";var e=function(){},t="undefined",i=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function n(e,t){var i=e[t];if("function"==typeof i.bind)return i.bind(e);try{return Function.prototype.bind.call(i,e)}catch(t){return function(){return Function.prototype.apply.apply(i,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&i?o:void 0!==console[r]?n(console,r):void 0!==console.log?n(console,"log"):e)}function s(t,i){for(var n=0;n<r.length;n++){var o=r[n];this[o]=n<t?e:this.methodFactory(o,t,i)}this.log=this.debug}function c(e,i,r){return function(){typeof console!==t&&(s.call(this,i,r),this[e].apply(this,arguments))}}function u(e,t,i){return a(e)||c.apply(this,arguments)}function d(e,i,n){var o,a=this,c="loglevel";function d(){var e;if(typeof window!==t){try{e=window.localStorage[c]}catch(e){}if(typeof e===t)try{var i=window.document.cookie,r=i.indexOf(encodeURIComponent(c)+"=");-1!==r&&(e=/^([^;]+)/.exec(i.slice(r))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}e&&(c+=":"+e),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=n||u,a.getLevel=function(){return o},a.setLevel=function(i,n){if("string"==typeof i&&void 0!==a.levels[i.toUpperCase()]&&(i=a.levels[i.toUpperCase()]),!("number"==typeof i&&i>=0&&i<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+i;if(o=i,!1!==n&&function(e){var i=(r[e]||"silent").toUpperCase();if(typeof window!==t){try{return void(window.localStorage[c]=i)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+i+";"}catch(e){}}}(i),s.call(a,i,e),typeof console===t&&i<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){d()||a.setLevel(e,!1)},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var l=d();null==l&&(l=null==i?"WARN":i),a.setLevel(l,!1)}var l=new d,f={};l.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=f[e];return t||(t=f[e]=new d(e,l.getLevel(),l.methodFactory)),t};var v=typeof window!==t?window.log:void 0;return l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=v),l},l.getLoggers=function(){return f},l}))},{}],31:[function(e,t,i){var r,n,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var u,d=[],l=!1,f=-1;function v(){l&&u&&(l=!1,u.length?d=u.concat(d):f=-1,d.length&&g())}function g(){if(!l){var e=c(v);l=!0;for(var t=d.length;t;){for(u=d,d=[];++f<t;)u&&u[f].run();f=-1,t=d.length}u=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new p(e,t)),1!==d.length||l||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],32:[function(e,t,i){"use strict";const r=(e,t)=>{const i=Array.isArray(e)?[]:{};t.push(e);for(const[n,o]of Object.entries(e))"function"!=typeof o&&(o&&"object"==typeof o?t.includes(e[n])?i[n]="[Circular]":i[n]=r(e[n],t.slice()):i[n]=o);const n=["name","message","stack","code"];for(const t of n)"string"==typeof e[t]&&(i[t]=e[t]);return i},n=e=>"object"==typeof e?r(e,[]):"function"==typeof e?`[Function: ${e.name||"anonymous"}]`:e;t.exports=n,t.exports.default=n},{}],33:[function(e,t,i){var r=e("./v1"),n=e("./v4"),o=n;o.v1=r,o.v4=n,t.exports=o},{"./v1":36,"./v4":37}],34:[function(e,t,i){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);t.exports=function(e,t){var i=t||0,n=r;return[n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],"-",n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]],n[e[i++]]].join("")}},{}],35:[function(e,t,i){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);t.exports=function(){return r(n),n}}else{var o=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},{}],36:[function(e,t,i){var r,n,o=e("./lib/rng"),a=e("./lib/bytesToUuid"),s=0,c=0;t.exports=function(e,t,i){var u=t&&i||0,d=t||[],l=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:n;if(null==l||null==f){var v=o();null==l&&(l=r=[1|v[0],v[1],v[2],v[3],v[4],v[5]]),null==f&&(f=n=16383&(v[6]<<8|v[7]))}var g=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:c+1,h=g-s+(p-c)/1e4;if(h<0&&void 0===e.clockseq&&(f=f+1&16383),(h<0||g>s)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=g,c=p,n=f;var m=(1e4*(268435455&(g+=122192928e5))+p)%4294967296;d[u++]=m>>>24&255,d[u++]=m>>>16&255,d[u++]=m>>>8&255,d[u++]=255&m;var y=g/4294967296*1e4&268435455;d[u++]=y>>>8&255,d[u++]=255&y,d[u++]=y>>>24&15|16,d[u++]=y>>>16&255,d[u++]=f>>>8|128,d[u++]=255&f;for(var b=0;b<6;++b)d[u+b]=l[b];return t||a(d)}},{"./lib/bytesToUuid":34,"./lib/rng":35}],37:[function(e,t,i){var r=e("./lib/rng"),n=e("./lib/bytesToUuid");t.exports=function(e,t,i){var o=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||n(a)}},{"./lib/bytesToUuid":34,"./lib/rng":35}],38:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./utils"),i),n(e("./model"),i)},{"./model":55,"./utils":62}],39:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],40:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],41:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],42:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],43:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],44:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],45:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],46:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],47:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.RenderingType=void 0,function(e){e.mvc="MvcRendering",e.javascript="JavaScriptRendering"}(i.RenderingType||(i.RenderingType={}))},{}],48:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],49:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],50:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],51:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],52:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],53:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],54:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./SingleLineTextField"),i),n(e("./MultiLineTextField"),i),n(e("./RichTextField"),i),n(e("./ReferenceField"),i),n(e("./ImageField"),i),n(e("./GeneralLinkField"),i)},{"./GeneralLinkField":48,"./ImageField":49,"./MultiLineTextField":50,"./ReferenceField":51,"./RichTextField":52,"./SingleLineTextField":53}],55:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./DataItem"),i),n(e("./DataSourceItem"),i),n(e("./PageItem"),i),n(e("./PageItemResponse"),i),n(e("./PageMvcNode"),i),n(e("./RenderingContext"),i),n(e("./RenderingNode"),i),n(e("./PageHtmlNode"),i),n(e("./PageModelsNode"),i),n(e("./fields"),i)},{"./DataItem":39,"./DataSourceItem":40,"./PageHtmlNode":41,"./PageItem":42,"./PageItemResponse":43,"./PageModelsNode":44,"./PageMvcNode":45,"./RenderingContext":46,"./RenderingNode":47,"./fields":54}],56:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],57:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],58:[function(e,t,i){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(i,"__esModule",{value:!0}),i.buildLayout=void 0;var n=e("@uniformdev/common"),o=e("."),a=e("..");i.buildLayout=function(e,t){var i,r;void 0===t&&(t=!1);var c=e.pageId,u=e.renderings,d=e.html,l=e.models,f=e.uniformContext,v=e.item,g=e.home,p=e.datasources;if(!p)throw new Error("no datasources");if(!d)throw new Error("no html");var h=f&&f.logger?f.logger:o.noopLogger;h.debug("Rendering dynamic layout of "+c);var m={},y=u;if(!y)throw new Error("no renderings");for(var b=0;b<y.length;++b){var k=y[b];if(k&&k.id){var w=(0,n.tryParseGuid)(k.renderingId),_=(0,n.tryParseGuid)(k.id),O=(k.placeholder||"").trim().toLowerCase()||"main",T=k.settings.DataSource?k.settings.DataSource.toLowerCase():"",x=(0,n.tryParseGuid)(T),D=k.componentName,E=x&&p[x]||void 0;if(x&&!E&&k.renderingType!==a.RenderingType.mvc)if(!(l&&l["".concat(w,"|").concat(_)])){h.warn("The '".concat(D||k.id,"' component's datasource '").concat(x,"' ('").concat(T,"') cannot be resolved and no registered models for component."));continue}var C=E||v,P={id:_,renderingId:w,renderingType:k.renderingType,componentName:D,settings:k.settings,datasource:x||"",hidden:!1,renderingContext:{pageId:c,item:C,page:v,home:g||v,placeholders:m,datasources:p,html:d,datasource:null===(i=k.settings)||void 0===i?void 0:i.DataSource,parameters:function(e){if(e)return s(new URLSearchParams(e))}(null===(r=k.settings)||void 0===r?void 0:r.Parameters),models:l}};if(t&&k.settings.Rules){var S=k.settings.Rules.Rules;if(S&&S.length>0)for(var A=0;A<S.length;++A){var N=S[A];if("00000000-0000-0000-0000-000000000000"===N.UniqueId){var U=N.Actions;if(U&&U.length>0)for(var j=0;j<U.length;++j){"Sitecore.Rules.ConditionalRenderings.HideRenderingAction"===U[j].type&&(P.hidden=!0)}}}}m.hasOwnProperty(O)||(m[O]=[]),m[O].push(P),h.debug("Registering "+P.renderingId+" to "+O)}else h.error("Rendering #"+b+" has no id: ",JSON.stringify(k?k.id:"undefined rendering"))}return m};var s=function(e){var t,i,n={};try{for(var o=r(e.keys()),a=o.next();!a.done;a=o.next()){var s=a.value;e.getAll(s).length>1?n[s]=e.getAll(s):n[s]=e.get(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}return n}},{".":62,"..":38,"@uniformdev/common":67}],59:[function(e,t,i){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.convertDataItemToRuntimeItem=void 0,i.convertDataItemToRuntimeItem=function e(t,i,n){if(!t)return null;var o=r(r({},t),{name:i||t.name,children:[]});(n||t.url)&&(o.url=n||t.url);var a=t.children;for(var s in a)if(a.hasOwnProperty(s)){var c=a[s],u=n?n+(n.endsWith("/")?"":"/")+s+(n.endsWith("/")?"":"/"):void 0;o.children.push(e(c,s,u))}return o}},{}],60:[function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var i,r,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(i,"__esModule",{value:!0}),i.getPageProps=i.getHtml=i.getDatasources=i.getDataItem=i.getPageItem=void 0;var o=e("@uniformdev/common"),a=e("@uniformdev/common"),s=e("./getPageUrl"),c=e("./convertDataItemToRuntimeItem"),u=e("./noopLogger");function d(e,t,i,o){return r(this,void 0,void 0,(function(){return n(this,(function(r){switch(r.label){case 0:return[4,l(e,t,"page",i,o)];case 1:return[2,r.sent()]}}))}))}function l(e,t,i,a,u){return r(this,void 0,void 0,(function(){var r,d,l;return n(this,(function(n){switch(n.label){case 0:return r=(0,s.getPageUrl)(t,i,u),a.debug("Making HTTP request (data): "+r),[4,(0,o.fetchWithRetry)(e,a,r,3)];case 1:if(200!==(d=n.sent()).status)throw new Error("No item, ajax request to "+d.url+" returned "+d.status+" code, text: "+d.statusText);return[4,d.json()];case 2:if(!(l=n.sent()).id)throw new Error("no item.id, "+r+", "+JSON.stringify(l));return[2,(0,c.convertDataItemToRuntimeItem)(l,void 0,t)]}}))}))}function f(e){return r(this,void 0,void 0,(function(){var t,i,r,o,s;return n(this,(function(n){for(r in t=e.datasources||{},i={},t)t.hasOwnProperty(r)&&(o=(0,c.convertDataItemToRuntimeItem)(t[r],void 0,void 0),s=(0,a.parseGuid)(r),i[s]=o);return[2,i]}))}))}function v(e){var t;return r(this,void 0,void 0,(function(){return n(this,(function(i){return[2,(null===(t=e.mvc)||void 0===t?void 0:t.html)||{}]}))}))}i.getPageItem=d,i.getDataItem=l,i.getDatasources=f,i.getHtml=v,i.getPageProps=function(e,t,i,o){var a,s,c,l,g;return void 0===o&&(o=u.noopLogger),r(this,void 0,void 0,(function(){var r,u,p,h,m,y,b,k,w;return n(this,(function(n){switch(n.label){case 0:if(o.debug("Rendering page with path: ".concat(t)),t&&t.startsWith("/-"))throw new Error("Must not be handled by page!");return r=t+(t.endsWith("/")?"":"/"),[4,d(e,r,o,i)];case 1:if(!(u=n.sent()))throw new Error("No context item passed");return o.debug("Resolved page '".concat(r,"'")),p=!!u.legacyReactDatasourcesEnabled,delete u.legacyReactDatasourcesEnabled,p?(m=h=u,h?[4,f(h)]:[3,3]):[3,8];case 2:return b=n.sent(),[3,4];case 3:b={},n.label=4;case 4:return y=b,h?[4,v(h)]:[3,6];case 5:return w=n.sent(),[3,7];case 6:w={},n.label=7;case 7:return k=w,[2,{pageId:h.id,lang:h.lang,path:r,renderings:null!==(a=u.renderings)&&void 0!==a?a:[],html:k,models:null!==(s=u.models)&&void 0!==s?s:{},datasources:y,item:h,page:h,home:m}];case 8:return[2,{pageId:u.id,lang:u.lang,path:r,renderings:null!==(c=u.renderings)&&void 0!==c?c:[],html:(null===(l=u.mvc)||void 0===l?void 0:l.html)||{},models:null!==(g=u.models)&&void 0!==g?g:{},datasources:{}}]}}))}))}},{"./convertDataItemToRuntimeItem":59,"./getPageUrl":61,"./noopLogger":63,"@uniformdev/common":67}],61:[function(e,t,i){(function(t){(function(){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getPageUrl=void 0;var r=e("@uniformdev/common");i.getPageUrl=function(e,i,n){var o,a=null!==(o=n.UNIFORM_API_SITENAME)&&void 0!==o?o:n.SITECORE_SITENAME,s=(0,r.trim)(e,"/");s||(s="");var c="/uniform/api/content/"+a+"/";c+=s?i+"/"+s:i;var u=(0,r.getEnv)(t.env,"UNIFORM_API_TOKEN",void 0);return(0,r.getApiUrlWithToken)(n,c,u)}}).call(this)}).call(this,e("_process"))},{"@uniformdev/common":67,_process:31}],62:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./buildLayout"),i),n(e("./convertDataItemToRuntimeItem"),i),n(e("./popVisibleRenderingsFromPlaceholdersMap"),i),n(e("./getPageProps"),i),n(e("./getPageUrl"),i),n(e("./parsePlaceholderKey"),i),n(e("./UniformContextProps"),i),n(e("./PageComponentProps"),i),n(e("./noopLogger"),i),n(e("./scriptLoader"),i)},{"./PageComponentProps":56,"./UniformContextProps":57,"./buildLayout":58,"./convertDataItemToRuntimeItem":59,"./getPageProps":60,"./getPageUrl":61,"./noopLogger":63,"./parsePlaceholderKey":64,"./popVisibleRenderingsFromPlaceholdersMap":65,"./scriptLoader":66}],63:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.noopLogger=void 0,i.noopLogger={debug:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},info:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},warn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},error:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}}},{}],64:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.parsePlaceholderKey=void 0;var r=e("@uniformdev/common");i.parsePlaceholderKey=function(e){return"/"===e?"/":(e=(e=e.trim()).toLowerCase(),e=(e=(0,r.trimEnd)(e,"/"))||"main")}},{"@uniformdev/common":67}],65:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.popVisibleRenderingsFromPlaceholdersMap=void 0;var r=e("@uniformdev/common");i.popVisibleRenderingsFromPlaceholdersMap=function(e,t,i){var n=[];return(0,r.keys)(e).forEach((function(r){if(r==t||!r.startsWith("/")&&t.endsWith("/"+r)){var o=e[r];o.forEach((function(e,r){e&&!e.hidden&&(i.debug("Adding "+e.componentName+" ["+e.id+"] to "+t+" (and removing from list of free renderings)"),n.push(e),o[r]=void 0)}))}})),n}},{"@uniformdev/common":67}],66:[function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var i,r,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(i,"__esModule",{value:!0}),i.getClientScriptLoader=void 0;var o=e("@uniformdev/common");function a(e,t){return r(this,void 0,void 0,(function(){var i,r,a,c,u,d,l,f,v;return n(this,(function(n){switch(n.label){case 0:if(i=t.cachedScripts,r=void 0===i?{}:i,a=t.callback,c=t.logger,u=void 0===c?(0,o.getNullLogger)():c,0==(d=Object.keys(e)).length)return[2,!0];if(l=[],d.forEach((function(t){r[t]!=e[t]&&l.push(t)})),0==l.length)return[2,!0];f=[],l.forEach((function(t){var i=e[t];f.push(s.js({id:t,url:i}))})),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Promise.all(f)];case 2:return(v=n.sent()).forEach((function(e){r[e.id]=e.url})),a&&(u.debug("Client script loader - Scripts were loaded so invoking callback.",{scripts:e}),a()),u.debug("Client script loader - Finished loading scripts.",{scripts:v}),[2,!0];case 3:return n.sent(),u.error("Client script loader - Error while loading scripts.",{scripts:e}),[2,!1];case 4:return[2]}}))}))}i.getClientScriptLoader=function(){return{type:"default",load:a}};var s={css:c("link"),js:c("script"),img:c("img")};function c(e){return function(t){return new Promise((function(i,r){var n=document.createElement(e),o=document.body,a="src";switch(n.onload=function(){i(t)},n.onerror=function(){n.remove(),r(t)},e){case"script":n.async=1!=t.notAsync,o=document.head;break;case"link":n.type="text/css",n.rel="stylesheet",a="href",o=document.head}var s=document.createAttribute(a);s.value=t.url,n.attributes.setNamedItem(s),o.appendChild(n)}))}}},{"@uniformdev/common":67}],67:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./logging"),i),n(e("./model"),i),n(e("./util"),i),n(e("./integration"),i)},{"./integration":69,"./logging":72,"./model":74,"./util":81}],68:[function(e,t,i){"use strict";function r(){return new RegExp("<esi:(when|foreach|assign) [^>]+>","gim")}function n(e,t){void 0===t&&(t=i.defaultEsiCharacterMap);var r=Object.keys(t).join("|"),n=new RegExp(r,"gim");return e.replace(n,(function(e){return t[e]}))}Object.defineProperty(i,"__esModule",{value:!0}),i.decodeHtmlWithEsi=i.decodeEsiOpenTag=i.createEsiOpenTagsRegExp=i.defaultEsiCharacterMap=void 0,i.defaultEsiCharacterMap={"&#x27;":"'","&amp;":"&","&gt;":">","&lt;":"<"},i.createEsiOpenTagsRegExp=r,i.decodeEsiOpenTag=n,i.decodeHtmlWithEsi=function(e,t){void 0===t&&(t=i.defaultEsiCharacterMap);var o=r();return e.replace(o,(function(e){return n(e,t)}))}},{}],69:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./decodeHtmlWithEsi"),i)},{"./decodeHtmlWithEsi":68}],70:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getNullLogger=i.NullLogger=void 0,i.NullLogger={debug:function(){},error:function(){},info:function(){},trace:function(){},warn:function(){}},i.getNullLogger=function(){return i.NullLogger}},{}],71:[function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.createConsoleLogger=void 0;var n=r(e("loglevel"));i.createConsoleLogger=function(e){var t=e.UNIFORM_OPTIONS_DEBUG?"debug":"warn";return n.default.setLevel(t),n.default}},{loglevel:30}],72:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./Logger"),i),n(e("./createConsoleLogger"),i)},{"./Logger":70,"./createConsoleLogger":71}],73:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],74:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./UniformConfig"),i)},{"./UniformConfig":73}],75:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ensureUniformSiteName=void 0;var r="uniform__";i.ensureUniformSiteName=function(e){return e?e.startsWith(r)?e:r+e:e}},{}],76:[function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.errorToJsonObject=void 0;var n=r(e("serialize-error"));i.errorToJsonObject=function(e){var t=(0,n.default)(e),i=e.data;return i&&(t.data=i),t}},{"serialize-error":32}],77:[function(e,t,i){(function(t){(function(){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var i,r,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i,"__esModule",{value:!0}),i.fetchWithRetry=void 0;var a=o(e("fetch-retry")),s=e("..");i.fetchWithRetry=function(e,i,o,c,u){return void 0===c&&(c=3),r(this,void 0,void 0,(function(){var r,d,l;return n(this,(function(n){switch(n.label){case 0:return r=(0,a.default)(e),u=u||parseInt((0,s.getEnv)(t.env,"UNIFORM_PUBLISH_PREFETCH_REQUEST_TIMEOUT","10000")),i.debug("HTTP request to "+o+(c>1?" (with max "+c+" retries)":"")+", timeout: "+u+"ms"),d=0,[4,r(o,{timeout:u,retries:c-1,retryOn:function(e,t,r){return!(e>=c)&&(r?200!==r.status&&404!==r.status:(i.debug("Keep retrying because no response"),!0))},retryDelay:function(e,t,r){d+=1;var n=1e3*Math.pow(2,e);return i.warn("Will retry in "+n/1e3+"s, url: "+o),n}})];case 1:return l=n.sent(),d&&i.info("Url was fetched after ".concat(d," attempts: ").concat(o)),[2,l]}}))}))}}).call(this)}).call(this,e("_process"))},{"..":67,_process:31,"fetch-retry":29}],78:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getApiUrlWithToken=void 0,i.getApiUrlWithToken=function(e,t,i){var r,n=null!==(r=e.UNIFORM_API_URL)&&void 0!==r?r:e.SITECORE_API_URL,o=new URL(n.endsWith("/")?n:n+"/");return t&&(t=t.toLowerCase(),o=new URL(t.startsWith(".")?t:"."+t,o)),e.UNIFORM_OPTIONS_PREVIEW&&o.searchParams.set("uniform_preview","true"),e.UNIFORM_OPTIONS_ESI&&o.searchParams.set("uniform_esi","true"),i&&o.searchParams.set("uniform_token",i),o.href}},{}],79:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getEnvEx=i.getBoolEnv=i.getEnv=void 0;var r=e("..");function n(e,t,i){return void 0===i&&(i=void 0),void 0===e?void 0===i?(0,r.throwException)("FATAL .env file lacks ".concat(t," value")):i:"[object String]"===Object.prototype.toString.call(e)?e.trim():e}i.getEnv=function(e,t,i){return void 0===i&&(i=void 0),n(e[t],t,i)},i.getBoolEnv=function(e,t,i){void 0===i&&(i=void 0);var n=e[t];return void 0===n?void 0===i?(0,r.throwException)("FATAL .env file lacks ".concat(t," bool value")):i:"true"===(n=n.toString().trim().toLowerCase())||"1"===n||"yes"===n},i.getEnvEx=n},{"..":67}],80:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getPropertyByPath=void 0,i.getPropertyByPath=function(e,t,i){return t.split(".").reduce((function(e,t){return e&&e[t]||i}),e)}},{}],81:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./throwException"),i),n(e("./keys"),i),n(e("./surround"),i),n(e("./parseGuid"),i),n(e("./tryParseGuid"),i),n(e("./tryFormatGuid"),i),n(e("./getEnv"),i),n(e("./getEnv"),i),n(e("./trim"),i),n(e("./replace"),i),n(e("./errorToJsonObject"),i),n(e("./getPropertyByPath"),i),n(e("./getApiUrlWithToken"),i),n(e("./parseUniformConfig"),i),n(e("./fetchWithRetry"),i),n(e("./ensureUniformSiteName"),i)},{"./ensureUniformSiteName":75,"./errorToJsonObject":76,"./fetchWithRetry":77,"./getApiUrlWithToken":78,"./getEnv":79,"./getPropertyByPath":80,"./keys":82,"./parseGuid":83,"./parseUniformConfig":84,"./replace":85,"./surround":86,"./throwException":87,"./trim":88,"./tryFormatGuid":89,"./tryParseGuid":90}],82:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.keys=void 0,i.keys=function(e){return e&&Object.getOwnPropertyNames(e)||[]}},{}],83:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.parseGuid=void 0;var r=e("..");i.parseGuid=function(e){return(0,r.tryParseGuid)(e)||(0,r.throwException)("Cannot parse GUID: ".concat(e))}},{"..":67}],84:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.parseUniformConfig=void 0;var r=e("..");i.parseUniformConfig=function(e,t){void 0===t&&(t=!0);var i=(0,r.getEnv)(e,"UNIFORM_API_URL",t?void 0:"");return{UNIFORM_API_URL:i,UNIFORM_API_SITENAME:(0,r.getEnv)(e,"UNIFORM_API_SITENAME",t?void 0:""),UNIFORM_CONTENT_URL:(0,r.getEnv)(e,"UNIFORM_CONTENT_URL",i),UNIFORM_API_MAPSERVICE:(0,r.getEnv)(e,"UNIFORM_API_MAPSERVICE","/uniform/api/content/${UNIFORM_API_SITENAME}/map"),UNIFORM_OPTIONS_PREVIEW:(0,r.getBoolEnv)(e,"UNIFORM_OPTIONS_PREVIEW",!0),UNIFORM_OPTIONS_DEBUG:(0,r.getBoolEnv)(e,"UNIFORM_OPTIONS_DEBUG",!1),UNIFORM_OPTIONS_PREFETCH_LINKS:(0,r.getBoolEnv)(e,"UNIFORM_OPTIONS_PREFETCH_LINKS",!1),UNIFORM_OPTIONS_ESI:(0,r.getBoolEnv)(e,"UNIFORM_OPTIONS_ESI",!1)}}},{"..":67}],85:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.replace=void 0,i.replace=function(e,t,i){var r=t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");return e.replace(new RegExp(r,"g"),i)}},{}],86:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.surround=void 0,i.surround=function(e,t){return e?(e.startsWith(t)?"":t)+e+(e.endsWith(t)?"":t):t}},{}],87:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.throwException=void 0,i.throwException=function(e){if("object"==typeof e&&e.stack)throw e;throw new Error(e||"Unknown error occurred, check stacktrace to get more info.")}},{}],88:[function(e,t,i){"use strict";function r(e,t){for(var i=-1;e.charAt(++i)===t;);return i}function n(e,t){for(var i=e.length;e.charAt(--i)===t;);return i+1}Object.defineProperty(i,"__esModule",{value:!0}),i.trimEnd=i.trimStart=i.trim=void 0,i.trim=function(e,t){return e.slice(r(e,t),n(e,t))},i.trimStart=function(e,t){return e.slice(r(e,t))},i.trimEnd=function(e,t){return e.slice(0,n(e,t))}},{}],89:[function(e,t,i){"use strict";function r(e){var t=e.replace(/[{}-]/g,"");return 32!==t.length?"":t}function n(e){if(36===e.length&&"-"===e[8])return e;var t=r(e);return t?"".concat(t.substring(0,8),"-").concat(t.substring(8,12),"-").concat(t.substring(12,16),"-").concat(t.substring(16,20),"-").concat(t.substring(20,32)):""}Object.defineProperty(i,"__esModule",{value:!0}),i.tryFormatGuid=void 0,i.tryFormatGuid=function(e,t){if(!e)return"";switch(t){case"N":return r(e.toLowerCase());case"D":return n(e.toLowerCase());case"B":return function(e){if(38===e.length&&"{"===e[0]&&"-"===e[9])return e;var t=n(e);return t?"{".concat(t,"}"):""}(e.toLowerCase());case"BU":return function(e){if(38===e.length&&"{"===e[0]&&"-"===e[9])return e.toUpperCase();var t=n(e).toUpperCase();return t?"{".concat(t,"}"):""}(e);default:throw new Error("format arg: unknown guid format")}}},{}],90:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.tryParseGuid=void 0;var r=/^([0-9A-F]{32})|[\{\[\(]?([0-9A-F]{8})\-([0-9A-F]{4})\-([0-9A-F]{4})\-([0-9A-F]{4})\-([0-9A-F]{12})[\]\}\)]?$/i;i.tryParseGuid=function(e){var t=r.exec(e||"");return t?t.reduce((function(e,t,i){return e+(i>0&&t?t:"")}),"").toLowerCase():""}},{}],91:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./subscriptions"),i),n(e("./queue"),i)},{"./queue":92,"./subscriptions":93}],92:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getUniformQueue=void 0;var r=e("./subscriptions");i.getUniformQueue=function(e){var t=new Map,i=(0,r.getSubscriptionManager)("".concat(e,"_SUBS"));return{id:e,add:function(e,r){var n,o=null!==(n=t.get(e))&&void 0!==n?n:[];-1==o.indexOf(r)&&(null==o||o.push(r),i.publish({type:e,when:new Date,entry:r})),t.set(e,o)},get:function(e){var i=t.get(e);if(i)return i.shift()},count:function(e){var i=t.get(e);return i?i.length:0},subscribe:function(e,t){return i.subscribe(e,t)}}}},{"./subscriptions":93}],93:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getSubscriptionManager=i.createUniformUnsubscribe=void 0;var r=e("@uniformdev/common"),n=e("uuid");function o(e){return{id:(0,n.v4)(),unsub:e}}i.createUniformUnsubscribe=o,i.getSubscriptionManager=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=(0,r.getNullLogger)()),i.debug("getSubscriptionManager - Getting subscription manager.",{id:e,isGlobal:t});var n=new Map;return{id:e,getSubscribers:function(e){var t;return null!==(t=n.get(e))&&void 0!==t?t:[]},getSubscriptionTypes:function(){var e=[];return Array.from(n.keys()).forEach((function(t){t&&e.push(t)})),e},publish:function(r){var o;if(i.debug("Default subscription manager - Publish",{id:e,data:r}),!0!==r.silent){var a=n.get(r.type);a&&a.forEach((function(e){return e(r)}));var s=n.get(void 0);s&&s.forEach((function(e){return e(r)})),1!=t&&(null===(o=window.uniform)||void 0===o?void 0:o.subscriptions)&&window.uniform.subscriptions.publish(r)}},subscribe:function(t,r){i.debug("Default subscription manager - Subscribe",{id:e,type:t,callback:r});var a=n.get(t);a||(a=[],n.set(t,a)),-1==a.indexOf(r)&&(a.push(r),n.set(t,a));return o((function(){var e=a.indexOf(r);return-1!=e&&(a.splice(e,1),!0)}))}}}},{"@uniformdev/common":67,uuid:33}],94:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./events"),i),n(e("./logging"),i),n(e("./model"),i),n(e("./util"),i)},{"./events":91,"./logging":96,"./model":98,"./util":103}],95:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getDefaultConsoleLogger=void 0,i.getDefaultConsoleLogger=function(e){return{debug:function(t,i){i=JSON.parse(JSON.stringify(null!=i?i:{})),console.debug((new Date).toISOString()+" [DEBUG] [".concat(e,"] ")+t,i)},info:function(t,i){i=JSON.parse(JSON.stringify(null!=i?i:{})),console.info((new Date).toISOString()+" [INFO]  [".concat(e,"] ")+t,i)},warn:function(t,i){i=JSON.parse(JSON.stringify(null!=i?i:{})),console.warn((new Date).toISOString()+" [WARN]  [".concat(e,"] ")+t,i)},error:function(t,i){i=JSON.parse(JSON.stringify(null!=i?i:{})),console.error((new Date).toISOString()+" [ERROR] [".concat(e,"] ")+t,i)}}}},{}],96:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./Logger"),i)},{"./Logger":95}],97:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],98:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./UniformOptimizeConfig"),i)},{"./UniformOptimizeConfig":97}],99:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.appendArray=i.flattenArray=void 0,i.flattenArray=function e(t,i){if(Array.isArray(t))for(var r=0;r<t.length;r++){var n=t[r];null!=n&&null!=n&&(Array.isArray(n)?e(n,i):-1==i.indexOf(n)&&i.push(n))}},i.appendArray=function(e,t){e&&e.forEach((function(e){-1==t.indexOf(e)&&t.push(e)}))}},{}],100:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.getNestedObjectProp=void 0,i.getNestedObjectProp=function(e,t,i){return t.split(".").reduce((function(e,t){return e?e[t]:i}),e)}},{}],101:[function(e,t,i){arguments[4][80][0].apply(i,arguments)},{dup:80}],102:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.initializeGlobalObject=void 0;var r=e("../events/subscriptions"),n=e("../events/queue");i.initializeGlobalObject=function(e){window?(window.uniform||(window.uniform={},e.debug("initializeGlobalObject - Uniform global object was created.")),window.uniform.subscriptions||(window.uniform.subscriptions=(0,r.getSubscriptionManager)("GLOBAL_SUBS",!0),e.debug("initializeGlobalObject - Subscription manager was added to Uniform global object.",{subscriptionManager:window.uniform.subscriptions.id})),window.uniform.queue||(window.uniform.queue=(0,n.getUniformQueue)("GLOBAL_QUEUE"),e.debug("initializeGlobalObject - Queue was added to Uniform global object.",{queueId:window.uniform.queue.id}))):e.error("initializeGlobalObject - Window global object is not available so Uniform global object cannot be initialized.")}},{"../events/queue":92,"../events/subscriptions":93}],103:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),n(e("./getPropertyByPath"),i),n(e("./getNestedObjectProp"),i),n(e("./global"),i),n(e("./arrays"),i),n(e("./objects"),i)},{"./arrays":99,"./getNestedObjectProp":100,"./getPropertyByPath":101,"./global":102,"./objects":104}],104:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.appendObject=void 0,i.appendObject=function(e,t){e&&Object.keys(e).forEach((function(i){t[i]=e[i]}))}},{}],105:[function(e,t,i){"use strict";i.__esModule=!0,i.getCookieValues=i.removeCookie=i.setCookie=i.getCookie=void 0;var r=e("@uniformdev/tracking");i.getCookie=r.getCookie,i.setCookie=r.setCookie,i.removeCookie=r.removeCookie,i.getCookieValues=function(e){var t=(0,r.getCookie)(e);return t?t.split(","):[]}},{"@uniformdev/tracking":138}],106:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};i.__esModule=!0,n(e("./tracker"),i),n(e("./visit"),i),n(e("./visitor"),i),n(e("./cookie"),i)},{"./cookie":105,"./tracker":107,"./visit":108,"./visitor":109}],107:[function(e,t,i){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var i,r,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};i.__esModule=!0,i.getHistory=i.addVisits=i.doTracking=i.initializeTracker=i.gaElems=i.gaNewElem=void 0;var s=e("@uniformdev/tracking"),c=e("@uniformdev/common"),u=e("@uniformdev/common-client"),d=e("@uniformdev/optimize-common-sitecore"),l=a(e("axios"));function f(e,t){if(!0!==(null==t?void 0:t.debug))return(0,c.getNullLogger)();if(t.logger)return t.logger;var i=(0,d.getDefaultConsoleLogger)("optimize-tracker");return i.debug("Uniform tracking - ".concat(e," - No logger was set in the settings but debug is enabled so use the default console logger."),{settings:t}),i}function v(e){if(e){var t=e.split(".");t.length>1&&"window"==t[0]&&t.splice(0,1);for(var i=window,r=0;r<t.length&&i;r++)i=i[t[r]];if(null!=i&&"function"==typeof i)return i}}function g(e){var t,a,c,l,g,p,h,m,y,b,k;return n(this,void 0,void 0,(function(){var n,w,_,O,T,x,D,E,C,P,S,A,N,U,j;return o(this,(function(o){switch(o.label){case 0:if(n=f("initializeTracker",e),!(w=function(e,t){var i,r;return(null===(i=null==e?void 0:e.context)||void 0===i?void 0:i.tracking)?(t.debug("Uniform tracking - initializeTracker - Using tracking config from settings to determine tracker cookie types.",{settings:e}),e.context):(null===(r=window.uniform)||void 0===r?void 0:r.tracking)?(t.debug("Uniform tracking - initializeTracker - Using tracking config from global object to determine tracker cookie types.",{global:window.uniform}),window.uniform.tracking):void 0}(e,n)))return n.error("Uniform tracking - initializeTracker - Unable to resolve tracking config so tracker cannot be initialized.",{settings:e}),[2,Promise.resolve(void 0)];if(!(null===(t=w.settings)||void 0===t?void 0:t.scripts))return[3,4];if((_=r({},w.settings.scripts)).optimize&&(delete _.optimize,n.debug("Uniform tracking - initializeTracker - Optimize script was removed from the collection of client scripts to load because that script is running this code.",{scripts:_})),!(O=(0,u.getClientScriptLoader)()))return n.error("Uniform tracking - initializeTracker - Unable to resolve script loader so tracker cannot be initialized.",{trackingConfig:w}),[2,Promise.resolve(void 0)];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,O.load(_,{logger:n})];case 2:return o.sent(),n.debug("Uniform tracking - initializeTracker - Scripts finished loading.",{scripts:_}),[3,4];case 3:return T=o.sent(),n.error("Uniform tracking - initializeTracker - Error occurred while loading scripts so tracker cannot be initialized.",{trackingConfig:w,scripts:_,error:T}),[2,Promise.reject(T)];case 4:return x=function(e,t){if(e){var i=v(e);null!=i&&"function"==typeof i?i&&D.subscribe(t,i):n.error("Uniform tracking - initializeTracker - Unable to add a tracker subscription because the specified function does not exist.",{name:e,type:t})}},D=(0,d.getSubscriptionManager)("OPTIMIZE_JS_TRACKER_SUBS",!1,n),function(e){return"mvc"==(null==e?void 0:e.mode)}(e)&&(n.debug("Uniform tracking - initializeTracker - Adding subscriptions for context cookies.",{settings:e}),function(e,t,i,r){var n=(0,s.getTrackerCookieSettings)(e);(0,s.addSubscriptionsForTrackerCookies)(t,{cookieSettings:n,getCookieName:null==i?void 0:i.getCookieName,getCookieValueFromVisitor:null==i?void 0:i.getCookieValueFromVisitor,getCookieValueFromVisit:null==i?void 0:i.getCookieValueFromVisit,logger:r,loggerPrefix:"Uniform tracking - initializeTracker",getCookie:s.getCookie,removeCookie:s.removeCookie,setCookie:s.setCookie})}(w,D,e,n)),x(e.onTrackingFinished,"tracking-finished"),x(e.onVisitCreated,"visit-created"),x(e.onVisitUpdated,"visit-updated"),x(e.onVisitorUpdated,"visitor-updated"),E=v(e.onDispatch),C=v(e.onBeforeDispatchData),P=(0,s.getDispatchersFromTrackingConfig)(w,{getCookie:s.getCookie,logger:n,loggerPrefix:"Uniform tracking - initializeTracker",removeCookie:s.removeCookie,setCookie:s.setCookie,ga:{initializeGa:function(e,t){var r,n,o,a,s,c,u;return window.ga||(t.error("Uniform tracking - initializeTracker - The global function ga is not defined, so initializing the GA library.",{destination:e}),u=new Date,r=window,n=document,o="script",a="ga",s=i.gaNewElem,c=i.gaElems,r.GoogleAnalyticsObject=a,r.ga=r.ga||function(){(r.ga.q=r.ga.q||[]).push(arguments)},r.ga.l=1*u,s=n.createElement(o),c=n.getElementsByTagName(o)[0],s.async=1,s.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(s,c)),window.ga?e.trackingIds?(e.trackingIds.forEach((function(i){try{window.ga("create",i,"auto"),t.debug("Uniform tracking - initializeTracker - GA tracker object was created.",{trackingId:i,destination:e})}catch(e){t.error("Uniform tracking - initializeTracker - Error while creating GA tracker object.",{trackingId:i,error:e})}})),!0):(t.debug("Uniform tracking - initializeTracker - No tracking ids set on GA destination so no GA tracker objects will be created.",{destination:e}),!1):(t.error("Uniform tracking - initializeTracker - The global function ga is not defined, suggesting the GA library has not been loaded.",{destination:e}),!1)}},ga4:{initializeGa4:function(e,t){var i;return t.debug("Uniform tracking - initializeTracker - do something",e),window.dataLayer||(t.debug("Uniform tracking - initializeTracker - initialize dataLayer for GA4.",e),window.dataLayer=[]),window.gtag=function(){window.dataLayer.push(arguments)},(null===(i=e.measurementIds)||void 0===i?void 0:i.length)>0&&(window.gtag("js",new Date),e.measurementIds.forEach((function(e){t.debug("Uniform tracking - initializing GA4 property.",e),window.gtag("config",e),t.debug("Uniform tracking - GA4 property initialized.",e)}))),!0}}}),S=null!==(a=e.campaignParameters)&&void 0!==a?a:null===(l=null===(c=w.settings)||void 0===c?void 0:c.campaigns)||void 0===l?void 0:l.parameters,A=null!==(g=e.goalParameters)&&void 0!==g?g:null===(h=null===(p=w.settings)||void 0===p?void 0:p.goals)||void 0===h?void 0:h.parameters,N=null!==(m=e.sessionTimeout)&&void 0!==m?m:null===(b=null===(y=w.settings)||void 0===y?void 0:y.session)||void 0===b?void 0:b.timeout,U={campaignParameters:S,dispatchers:P,onDispatch:E,onBeforeDispatchData:C,goalParameters:A,sessionTimeout:null!=N?N:20,storage:null!==(k=e.storage)&&void 0!==k?k:"default",subscriptions:D,type:"js"},(j=(0,s.getSitecoreTracker)(U,n))?(window.uniform||(window.uniform={}),window.uniform.tracker=j,[2,Promise.resolve(j)]):(n.error("Uniform tracking - initializeTracker - No tracker was returned from getSitecoreTracker.",{args:U}),[2,Promise.resolve(void 0)])}}))}))}i.gaNewElem={},i.gaElems={},i.initializeTracker=g,i.doTracking=function(e){var t,i=this,r=f("doTracking",e);if(window.uniform){var a=e.source;if(a){var c=null!==(t=e.context)&&void 0!==t?t:window.uniform;if(c){var u=function(t){return n(i,void 0,void 0,(function(){var i,n,u,d,l,f,v,g,p,h,m,y,b,k;return o(this,(function(o){switch(o.label){case 0:return t?(r.debug("Uniform tracking - doTracking - Tracker is available.",{settings:e}),(i=(0,s.getCookie)(s.UniformCookieNames.VisitorId))?r.debug("Uniform tracking - doTracking - Visitor id was retrieved from cookie.",{visitorId:i,cookie:s.UniformCookieNames.VisitorId}):r.debug("Uniform tracking - doTracking - No visitor id was retrieved from cookie.",{cookie:s.UniformCookieNames.VisitorId}),(n=(0,s.getCookie)(s.UniformCookieNames.VisitId))?r.debug("Uniform tracking - doTracking - Visit id was retrieved from cookie.",{visitId:n,cookie:s.UniformCookieNames.VisitId}):r.debug("Uniform tracking - doTracking - No visit id was retrieved from cookie.",{cookie:s.UniformCookieNames.VisitId}),u={visitId:n,visitorId:i,createVisitor:!0,silent:e.silent,lastActivity:null===(m=null===(h=null===(p=window.uniform)||void 0===p?void 0:p.tracking)||void 0===h?void 0:h.visit)||void 0===m?void 0:m.lastActivity,isNew:null===(k=null===(b=null===(y=window.uniform)||void 0===y?void 0:y.tracking)||void 0===b?void 0:b.visit)||void 0===k?void 0:k.isNew},e.onVisitorInitialized&&((d=window[e.onVisitorInitialized])?(u.onVisitorInitialized=d,r.debug("Uniform tracking - doTracking - Handler for visitor initialization set on tracking settings.",{onVisitorInitialized:e.onVisitorInitialized})):r.error("Uniform tracking - doTracking - Handler for visitor initialization was specified but the function does not exist.",{onVisitorInitialized:e.onVisitorInitialized})),[4,t.track(a,c,u)]):(r.error("Uniform tracking - doTracking - No tracker is available.",{settings:e}),[2]);case 1:return l=o.sent(),r.debug("Uniform tracking - doTracking - Tracking results were returned.",{results:l}),l&&(l.visitor&&((0,s.setCookie)(s.UniformCookieNames.VisitorId,l.visitor.id,3650),r.debug("Uniform tracking - doTracking - Visitor id cookie was updated.",{visitorId:i,cookie:s.UniformCookieNames.VisitorId})),l.visit&&((0,s.setCookie)(s.UniformCookieNames.VisitId,l.visit.id),r.debug("Uniform tracking - doTracking - Visit id cookie was updated.",{visitorId:i,cookie:s.UniformCookieNames.VisitId}),f=[new Date(l.visit.start).getTime(),new Date(l.visit.updated).getTime()],e.sessionTimeout&&f.push(e.sessionTimeout),v=(0,s.getCookie)(s.UniformCookieNames.VisitState),g=f.join("|"),(0,s.setCookie)(s.UniformCookieNames.VisitState,g),r.debug("Uniform tracking - doTracking - Visit state cookie was updated.",{old:v,new:g,cookie:s.UniformCookieNames.VisitState}))),[2]}}))}))};window.uniform.tracker?(r.debug("Uniform tracking - doTracking - Using the tracker set on the global object.",{settings:e}),u(window.uniform.tracker)):g(e).then((function(t){r.debug("Uniform tracking - doTracking - Using the newly initialized tracker.",{settings:e}),u(t).then((function(){r.debug("Uniform tracking - doTracking - Tracking is finished.",{settings:e})}))}))}else r.warn("Uniform tracking - doTracking - No context was was resolved.",{settings:e})}else r.error("Uniform tracking - doTracking - No source was specified.",{settings:e})}},i.addVisits=function(e,t){return(0,s.addVisits)(e,t)},i.getHistory=function(e,t,i){return n(this,void 0,void 0,(function(){var r;return o(this,(function(n){switch(n.label){case 0:return e?(null==t?void 0:t.id)?[4,l.default.get("/uniform/api/content/".concat(e,"/xdb/history/").concat(t.id))]:[2,Promise.reject("Uniform visitor must be specified.")]:[2,Promise.reject("Sitecore site name must be specified.")];case 1:return r=n.sent(),i.debug("Uniform tracking - getHistory - Data retrieved.",{data:r.data}),[2,Promise.resolve(r.data)]}}))}))}},{"@uniformdev/common":67,"@uniformdev/common-client":38,"@uniformdev/optimize-common-sitecore":94,"@uniformdev/tracking":138,axios:1}],108:[function(e,t,i){"use strict";i.__esModule=!0,i.getVisitGoals=void 0;var r=e("@uniformdev/tracking");i.getVisitGoals=function(e){return(0,r.getVisitActivities)("goal",e)}},{"@uniformdev/tracking":138}],109:[function(e,t,i){"use strict";i.__esModule=!0,i.getVisitorGoals=i.getVisitorProfilePatternMatch=i.getVisitorProperty=void 0;var r=e("@uniformdev/tracking");function n(){var e;return null===(e=null===window||void 0===window?void 0:window.uniform)||void 0===e?void 0:e.visitor}i.getVisitorProperty=function(e){if(e){var t=n();if(t){var i=Object.keys(t).findIndex((function(t){return t==e}));if(-1!=i)return Object.values(t)[i]}}},i.getVisitorProfilePatternMatch=function(e,t){var i,r;if(e){var o=n();if(o){var a=null===(r=null===(i=o.data)||void 0===i?void 0:i.patterns)||void 0===r?void 0:r.data;if(a&&a[e])return!0===t?a[e].patternId:a[e].name}}},i.getVisitorGoals=function(e){return(0,r.getVisitorActivities)("goal",e)}},{"@uniformdev/tracking":138}],110:[function(e,t,i){t.exports={version:"0.0.0-uniformdev"}},{}],111:[function(e,t,i){"use strict";i.__esModule=!0,i.Ga4Destination=void 0;var r=function(){this.mappings=[],this.measurementIds=[],this.eventName="uniform_event",this.type="ga4"};i.Ga4Destination=r},{}],112:[function(e,t,i){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};i.__esModule=!0,i.Ga4Dispatcher=void 0;var n=function(){function e(e,t){var i=this;this.requiresBrowser=!0,this.type="ga4",this.getUserValues=function(e,t){var r={dimensions:{}},n=i.destination.mappings;return n&&n.forEach((function(e){if(e.action){var t=new Function(e.action)();t&&(e.isIdentifier?r.identifier=t:e.dimensionName&&(r.dimensions[e.dimensionName]=t))}})),t.debug("GA4 dispatcher - Converted tracking results into Google Analytics data model.",{values:r}),r},this.converters=e,this.destination=t}return e.prototype.dispatchActivity=function(e,t,i){var n=this,o=this.destination.measurementIds;if(o&&0!=o.length)if(e)if("function"==typeof window.gtag){var a=this.destination.activities;if(a&&0==a.length)i.debug("GA4 dispatcher - An empty array of activities was specified so no activities will be dispatched.",{settings:t});else{var s=[];e.visitActivities.forEach((function(e){if(a&&-1==a.indexOf(e.type))i.debug("GA4 dispatcher - The activity type was not selected as an activity to dispatch.",{type:e.type,allowed:a,activity:e,settings:t});else for(var r=0;r<n.converters.length;r++){var o=n.converters[r].convert(e);o?(i.debug("GA4 dispatcher - The activity was converted into a format that can be dispatched.",{activity:e,gaEvent:o,settings:t}),s.push(o)):i.debug("GA4 dispatcher - The activity was not converted into a format that can be dispatched.",{activity:e,settings:t})}}));var c=this.getUserValues(e,i),u=c.identifier,d=c.dimensions,l=void 0===d?{}:d;u&&(null==o||o.forEach((function(e){i.debug("GA4 dispatcher - Setting user identifier.",{measurementId:e,identifier:c.identifier}),gtag("config",e,{user_id:c.identifier})})));var f=t.onBeforeDispatchData;s.forEach((function(e){var t=n.destination.eventName,o=void 0===t?"uniform_event":t,a=r(r({},l),e),s={eventName:o,eventParams:a};!f||(s=f(n.type,s,i))?(i.debug("GA4 dispatcher - Sending event.",r({},s)),gtag("event",s.eventName,s.eventParams)):i.debug("GA4 dispatcher - Cancelling dispatch because no event data is available.",{originalData:{eventName:o,eventParams:a}})}))}}else i.error("GA4 dispatcher - GA tracking script has not been loaded. The tracking script must be loaded before the GA4 dispatcher can dispatch events to GA. Dispatch aborted.",{measurementIds:o,activity:e,settings:t});else i.debug("GA4 dispatcher - No tracked activity results are available to dispatch.",{settings:t});else i.debug("GA4 dispatcher - No measurement ids are set on the destination so no activities will be dispatched.",{destination:this.destination})},e}();i.Ga4Dispatcher=n},{}],113:[function(e,t,i){"use strict";i.__esModule=!0,i.GaDestination=void 0;var r=function(e,t){this.type="ga",this.trackingIds=e,Object.assign(this,t)};i.GaDestination=r},{}],114:[function(e,t,i){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};i.__esModule=!0,i.GaDispatcher=void 0;var n=function(){function e(e,t){this.requiresBrowser=!0,this.type="ga",this.activities=null==t?void 0:t.activities,this.converters=e,this.trackingIds=null==t?void 0:t.trackingIds,this.setCustomDimensionValues=null==t?void 0:t.setCustomDimensionValues}return e.prototype.getCustomDimensionFields=function(e,t){var i={},r=new Map;return this.setCustomDimensionValues&&this.setCustomDimensionValues(e,r),r.forEach((function(e,t){i["dimension".concat(t)]=e})),t.debug("GA dispatcher - Converted tracking results into Google Analytics custom dimensions.",{map:r,fields:i}),i},e.prototype.dispatchActivity=function(e,t,i){var n,o=this;if(e)if(window.ga)if(this.activities&&0==this.activities.length)i.debug("GA dispatcher - An empty array of activities was specified so no activities will be dispatched.",{settings:t});else{var a=[];e.visitActivities.forEach((function(e){if(o.activities&&-1==o.activities.indexOf(e.type))i.debug("GA dispatcher - The activity type was not selected as an activity to dispatch.",{type:e.type,allowed:o.activities,activity:e,settings:t});else for(var r=0;r<o.converters.length;r++){var n=o.converters[r].convert(e);n?(i.debug("GA dispatcher - The activity was converted into a format that can be dispatched.",{activity:e,gaEvent:n,settings:t}),a.push(n)):i.debug("GA dispatcher - The activity was not converted into a format that can be dispatched.",{activity:e,settings:t})}}));var s=this.getCustomDimensionFields(e,i);if(0==a.length)return i.debug("GA dispatcher - No GA events were resolved, so no events will be dispatched.",{settings:t}),void(s&&Object.keys(s).length>0&&i.debug("GA dispatcher - Since no events will be dispatched, no custom dimensions will be dispatched.",{fields:s,settings:t}));null===(n=this.trackingIds)||void 0===n||n.forEach((function(e){i.debug("GA dispatcher - Creating tracker for tracking id "+e,{settings:t}),window.ga("create",e,"auto",e)}));var c=this.trackingIds,u=this.type;window.ga((function(e){var n=[];if(c?(i.debug("GA dispatcher - Events will be dispatched to the specified Google Analytics tracker(s).",{trackingIds:c,settings:t}),null==c||c.forEach((function(e){var t=window.ga.getByName(e);t&&n.push(t)}))):(i.debug("GA dispatcher - No tracking ids were specified, so events will be dispatched to all Google Analytics trackers.",{settings:t}),window.ga.getAll().forEach((function(e){n.push(e)}))),0!=n.length){i.debug("GA dispatcher - Ready to dispatch events to Google Analytics.",{events:a,trackers:n.map((function(e){return e.get("name")})),settings:t});var o=t.onBeforeDispatchData;n.forEach((function(e){a.forEach((function(n){var a={event:n,fields:s};!o||(a=o(u,a,i))?function(e,t,i,n,o){i.nonInteraction=!0;var a=e.get("trackingId");e.send("event",t.category,t.action,t.label,t.value,i),o.debug("GA dispatcher - Event dispatched to Google Analytics.",r(r({trackingId:a},t),{fields:i,settings:n}))}(e,a.event,a.fields,t,i):i.debug("GA dispatcher - Cancelling dispatch because no event data is available.",{originalData:{event:n,fields:s}})}))}))}else i.debug("GA dispatcher - No trackers were resolved, so no events will be dispatched to Google Analytics.",{trackingIds:c,settings:t})}))}else i.error("GA dispatcher - GA tracking script has not been loaded. The tracking script must be loaded before the GA dispatcher can dispatch events to GA. Dispatch aborted.",{trackingIds:this.trackingIds,activity:e,settings:t});else i.debug("GA dispatcher - No tracked activity results are available to dispatch.",{settings:t})},e}();i.GaDispatcher=n},{}],115:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};i.__esModule=!0,n(e("./ga/destination"),i),n(e("./ga/dispatcher"),i),n(e("./ga4/destination"),i),n(e("./ga4/dispatcher"),i),n(e("./oracleDmp/contextReaders"),i),n(e("./oracleDmp/destination"),i),n(e("./oracleDmp/dispatcher"),i),n(e("./sitecore/tracker"),i),n(e("./sitecore/gaEventConverter"),i),n(e("./sitecore/ga4EventConverter"),i),n(e("./sitecore/oracleDmpEventConverter"),i),n(e("./sitecore/contextReaders"),i),n(e("./sitecore/activities"),i),n(e("./sitecore/destination"),i),n(e("./sitecore/dispatcher"),i),n(e("./sitecore/cookies"),i),n(e("./sitecore/profiles"),i)},{"./ga/destination":113,"./ga/dispatcher":114,"./ga4/destination":111,"./ga4/dispatcher":112,"./oracleDmp/contextReaders":116,"./oracleDmp/destination":117,"./oracleDmp/dispatcher":118,"./sitecore/activities":119,"./sitecore/contextReaders":120,"./sitecore/cookies":121,"./sitecore/destination":122,"./sitecore/dispatcher":123,"./sitecore/ga4EventConverter":124,"./sitecore/gaEventConverter":125,"./sitecore/oracleDmpEventConverter":126,"./sitecore/profiles":128,"./sitecore/tracker":130}],116:[function(e,t,i){"use strict";i.__esModule=!0,i.getOracleDmpContextReader=void 0;var r=e("@uniformdev/common"),n=e("../../models");i.getOracleDmpContextReader=function(){return{type:"oracleDmp",getTrackedActivity:function(e,t){var i=t.url,o=t.context,a=t.visit,s=t.visitor,c=t.date,u=t.logger,d=void 0===u?(0,r.getNullLogger)():u;console.log(i+c);var l=new n.TrackedActivityResults(a,s);return"oracleDmp"!==e||d.debug("Oracle DMP context reader - Reading tracking activity from context.",{context:o}),l}}}},{"../../models":139,"@uniformdev/common":67}],117:[function(e,t,i){"use strict";i.__esModule=!0,i.OracleDmpDestination=void 0;var r=function(e,t){this.type="oracleDmp",this.containerIds=e,Object.assign(this,t)};i.OracleDmpDestination=r},{}],118:[function(e,t,i){"use strict";function r(e){if(e)return"callback_".concat(e)}i.__esModule=!0,i.OracleDmpDispatcher=i.getOracleDmpCallbackName=void 0,i.getOracleDmpCallbackName=r;var n=function(){function e(e,t){this.requiresBrowser=!0,this.type="oracleDmp",this.activities=null==t?void 0:t.activities,this.converters=e,this.containerIds=null==t?void 0:t.containerIds}return e.prototype.dispatchActivity=function(e,t,i){var n,o=this;if(e)if(this.containerIds&&0==this.containerIds.length)i.debug("Oracle DMP dispatcher - An empty array of tracking ids means dispatch is disabled.",{activity:e,settings:t});else if(window.bk_doCallbackTag)if(this.activities&&0==this.activities.length)i.debug("Oracle DMP dispatcher - An empty array of activities was specified so no activities will be dispatched.",{settings:t});else{var a=[];e.visitActivities.forEach((function(e){if(o.activities&&-1==o.activities.indexOf(e.type))i.debug("Oracle DMP dispatcher - The activity type was not selected as an activity to dispatch.",{type:e.type,allowed:o.activities,activity:e,settings:t});else for(var r=0;r<o.converters.length;r++){var n=o.converters[r].convert(e);n?(i.debug("Oracle DMP dispatcher - The activity was converted into a format that can be dispatched.",{activity:e,phints:n,settings:t}),a.push(n)):i.debug("Oracle DMP dispatcher - The activity was not converted into a format that can be dispatched.",{activity:e,settings:t})}})),0!=a.length?(window.bk_allow_multiple_calls=!0,window.bk_use_multiple_iframes=!0,null===(n=this.containerIds)||void 0===n||n.forEach((function(e){i.debug("Oracle DMP dispatcher - Adding phints to page context for container "+e,{phintsArray:a,settings:t}),a.forEach((function(e){Object.keys(e).forEach((function(t){window.bk_addPageCtx(t,e[t])}))}));var n=r(e);n?(i.debug("Oracle DMP dispatcher - Dispatching phints to container "+e,{callbackName:n,phintsArray:a,settings:t}),window.bk_doCallbackTag(e,n)):i.error("Oracle DMP dispatcher - Unable to determine callback name for container "+e,{settings:t})}))):i.debug("Oracle DMP dispatcher - No Oracle DMP phints were resolved, so no phints will be dispatched.",{settings:t})}else i.error("Oracle DMP dispatcher - Oracle DMP tracking script has not been loaded. The tracking script must be loaded before phints can be dispatched. Dispatch aborted.",{containerIds:this.containerIds,activity:e,settings:t});else i.debug("Oracle DMP dispatcher - No tracked activity results are available to dispatch.",{settings:t})},e}();i.OracleDmpDispatcher=n},{}],119:[function(e,t,i){"use strict";i.__esModule=!0,i.getVisitorActivities=i.getVisitActivities=void 0;var r=e("@uniformdev/common");function n(e,t,i,n){var o;void 0===i&&(i=(0,r.getNullLogger)());var a={};if(t){var s=null===(o=t.data)||void 0===o?void 0:o.activities;if(s)s.filter((function(t){return t.type==e})).forEach((function(r){var o,s,c;if(null===(o=r.data)||void 0===o?void 0:o.id)if(r.date){var u=null===(s=r.data)||void 0===s?void 0:s.id,d=new Date(r.date);if(u&&d){var l=null!==(c=a[u])&&void 0!==c?c:[];l.push(d),a[u]=l}}else i.debug("".concat(n," - Activity was found on the visit but no date is set, so unable to include this activity in the activity results."),{type:e,activity:r,visit:t.id,visitor:t.visitorId});else i.debug("".concat(n," - Activity was found on the visit but no id is set, so unable to include this activity in the activity results."),{type:e,activity:r,visit:t.id,visitor:t.visitorId})}))}return a}i.getVisitActivities=n,i.getVisitorActivities=function(e,t,i,o){void 0===i&&(i=(0,r.getNullLogger)());var a={};return(null==t?void 0:t.visits)&&t.visits.forEach((function(t){var r=n(e,t,i,o);r&&Object.keys(r).forEach((function(e){var t=r[e];if(t)if(a[e]){var i=a[e];t.forEach((function(e){-1==i.findIndex((function(t){return t.getTime()===e.getTime()}))&&i.push(e)}))}else a[e]=t}))})),a}},{"@uniformdev/common":67}],120:[function(e,t,i){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};i.__esModule=!0,i.getSitecoreContextReader=i.CONTEXT_SOURCE_SITECORE=void 0;var n=e("../../models/trackedActivity"),o=e("./patternMatchers"),a=e("@uniformdev/common"),s=e("./scoring");function c(e,t){var i,r,n,o;return{campaigns:t.campaigns,campaignParameters:null===(r=null===(i=t.settings)||void 0===i?void 0:i.campaigns)||void 0===r?void 0:r.parameters,goals:t.goals,goalParameters:null===(o=null===(n=t.settings)||void 0===n?void 0:n.goals)||void 0===o?void 0:o.parameters,page:{item:t.item,url:e},pageEvents:t.events,personalization:t.personalization,profiles:t.profiles}}function u(e,t,i,n,c){c.debug("Sitecore context reader - START: reading activity results.",{context:e,date:t,activity:i,settings:n}),e.page?(function(e,t,i,r){if(!e)return;t.visitActivities.push({type:"page view",date:i,data:e})}(e.page,i,t),e.page.url?function(e,t,i,r,n){if(!e)return;(null==t?void 0:t.campaignParameters)&&t.campaignParameters.forEach((function(t){var o=e.getAll(t);if(o.length>0){var s={};o.forEach((function(e){var t=(0,a.tryFormatGuid)(e,"D"),i=t?null:e;s[t]={name:i}})),y(s,i,r,n)}}));(null==t?void 0:t.goalParameters)&&t.goalParameters.forEach((function(t){var o=e.getAll(t);if(o.length>0){var s={};o.forEach((function(e){var t=(0,a.tryFormatGuid)(e,"D"),i=t?null:e;s[t]={name:i}})),d(s,i,r,n)}}))}(e.page.url.searchParams,e,i,t,c):c.debug("Sitecore context reader -   * No page url was found in the context so no query string parameters will be tracked.",e)):c.debug("Sitecore context reader -   * No page was found in the context so page view will not be tracked.",e),e.goals?d(e.goals,i,t,c):c.debug("Sitecore context reader -   * No goals were found in the context so none will be tracked.",e),e.pageEvents?function(e,t,i,n){if(!e)return;Object.keys(e).forEach((function(n){var o=e[n];t.visitActivities.push({type:"page event",date:i,data:r({id:n},o)})}))}(e.pageEvents,i,t):c.debug("Sitecore context reader -   * No page events were found in the context so none will be tracked.",e),e.campaigns?y(e.campaigns,i,t,c):c.debug("Sitecore context reader -   * No campaigns were found in the context so none will be tracked.",e);var u=function(e){if(!(null==e?void 0:e.goals))return 0;var t=0;return Object.keys(e.goals).forEach((function(i){var r=e.goals[i];isNaN(null==r?void 0:r.points)||(t+=r.points)})),Object.keys(e.pageEvents).forEach((function(i){var r=e.pageEvents[i];isNaN(null==r?void 0:r.points)||(t+=r.points)})),t}(e);0==u?c.debug("Sitecore context reader -   * No changes to engagement value were found in the context so it will not be updated.",e):function(e,t,i,r){if(isNaN(e)||e<=0)return;var n=function(t){var r,n;t.data||(t.data={});var o=null!==(n=null===(r=t.data.value)||void 0===r?void 0:r.data)&&void 0!==n?n:0;t.data.value={date:i,data:o+e}};t.visitUpdateCommands.push((function(e){n(e)})),t.visitorUpdateCommands.push((function(e){n(e)}))}(u,i,t),e.profiles?function(e,t,i,r){if(!e||!t.visit)return;var n=(0,o.getPatternMatcher)();n||r.warn("Sitecore context reader -   * No pattern matcher was resolved, so no pattern matches will be tracked.");var a={},c={},u={},d={};Object.keys(e).forEach((function(o){var l=e[o],f=(0,s.getScorer)(l.type);if(f){var m={id:o,keys:{}},y=!1;if(Object.keys(l.keys).forEach((function(e){var t=l.keys[e];m.keys[e]=t.value,t.value>0&&(y=!0)})),y){t.visitActivities.push({type:"profile score",date:i,data:m});var b=v(o,t.visit),k=g(o,t.visit),w=f(b,o,l,k),_=v(o,t.visitor),O=g(o,t.visitor),T=f(_,o,l,O);a[o]||(a[o]={updateCount:0});var x=a[o];c[o]||(c[o]={updateCount:0});var D=c[o];x.updateCount=w.updateCount,D.updateCount=T.updateCount,p(w,x,l),a[o]=x,p(T,D,l),c[o]=D,h(n,l,w,u,o),h(n,l,T,d,o)}else r.debug("Sitecore context reader -   * No profile key values were greater than zero, so this profile will not be tracked.",l)}else r.error("Sitecore context reader -   * No scorer was resolved, so this profile will not be tracked.",l)}));var l=m(i,a,u);0==l.length?r.debug("Sitecore context reader -   * No profile scores changed on the visit, so no profile scoring will be tracked."):l.forEach((function(e){t.visitUpdates.push(e)}));var f=m(i,c,d);0==f.length?r.debug("Sitecore context reader -   * No profile scores changed on the visitor, so no profile scoring will be tracked."):f.forEach((function(e){t.visitorUpdates.push(e)}))}(e.profiles,i,t,c):c.debug("Sitecore context reader -   * No profiles were found in the context so none will be tracked.",e);var f=e.personalization;f?function(e,t,i,r,n){var o,a;if(!e)return;n.debug("Sitecore context reader -   * Looking for unmet personalization dependencies.",{personalization:e,settings:r});var s=[];if(Object.keys(e).forEach((function(t){var i=e[t];l(null==i?void 0:i.dependencies).forEach((function(e){-1==s.indexOf(e)&&s.push(e)}))})),s.length>0){var c=null!==(a=null===(o=null==r?void 0:r.personalization)||void 0===o?void 0:o.dependenciesToIgnore)&&void 0!==a?a:[],u=[];if(s.forEach((function(e){-1==c.indexOf(e)&&u.push(e)})),u.length>0)return void n.debug("Sitecore context reader -   * Unmet personalization dependencies were found, so do not add origin-based personalization.",{dependencies:s,unmetDependencies:u,personalization:e,settings:r})}n.debug("Sitecore context reader -   * No unmet personalization dependencies were found.",{dependencies:s,personalization:e,settings:r});var d=[];Object.keys(e).forEach((function(r){var o=e[r];if(null==o?void 0:o.activity){var a={type:"personalization",date:i,data:o.activity};n.debug("Sitecore context reader -   * Adding personalization activity from origin-based personalization to tracked activity results.",{rendering:r,event:a}),t.visitActivities.push(a),d.push(a)}})),0==d.length?n.debug("Sitecore context reader -   * No origin-based personalization events were resolved.",{personalization:e}):n.debug("Sitecore context reader -   * Origin-based personalization events were added to tracked activity results.",{activities:d,personalization:e})}(f,i,t,n,c):c.debug("Sitecore context reader -   * No personalization details were found, so no origin-generated personalization activity will be tracked. Note: Personalization details will only be included when origin-based personalization occurs. If no origin-based personalization is used, this message indicates things are working as expected.",e),c.debug("Sitecore context reader - END: reading activity results.",{context:e,date:t,activity:i,settings:n})}function d(e,t,i,n){e&&Object.keys(e).forEach((function(n){var o=e[n];t.visitActivities.push({type:"goal",date:i,data:r({id:n},o)})}))}function l(e){if(!e)return[];if(!Array.isArray(e))return[e];var t=[];return Array.isArray(e)&&e.forEach((function(e){l(e).forEach((function(e){-1==t.indexOf(e)&&t.push(e)}))})),t}function f(e,t){var i,r,n=null===(r=null===(i=t.data)||void 0===i?void 0:i.profiles)||void 0===r?void 0:r.data;if(n)return n[e]}function v(e,t){var i={},r=f(e,t);return r&&(i.updateCount=r.updateCount,Object.keys(r.keys).forEach((function(e){i[e]=r.keys[e].value}))),i}function g(e,t){var i=f(e,t);return i?i.updateCount:0}function p(e,t,i){Object.keys(e.keys).forEach((function(r){var n=e.keys[r];t.keys||(t.keys={}),t.keys[r]||(t.keys[r]={}),i.name&&(t.name=i.name);var o=void 0;if(i.keys){var a=i.keys[r];a&&(o=a.name)}var s=t.keys[r];o&&(s.name=o),s.value=n}))}function h(e,t,i,r,n){if(e&&t.patterns){var o=e.match(i.keys,t);if(o){var a=t.patterns[o.patternId],s={profileName:t.name,patternId:o.patternId,distance:o.distance,name:a.name};r[n]=s}else delete r[n]}}function m(e,t,i){var r=[];return Object.keys(t).length>0&&(Object.keys(t).length>0&&r.push({type:"profiles",date:e,data:t}),Object.keys(i).length>0&&r.push({type:"patterns",date:e,data:i})),r}function y(e,t,i,r){if(e){var n=function(e,t,i){var r=[];if(e)for(var n in e){var o=e[n];r.push({id:n,name:o.name})}return r}(e);0!=n.length&&(n.forEach((function(e){t.visitActivities.push({type:"campaign",date:i,data:e})})),t.visitUpdates.push({type:"campaign",date:i,data:n[n.length-1]}))}}i.CONTEXT_SOURCE_SITECORE="sitecore",i.getSitecoreContextReader=function(e,t){switch(void 0===t&&(t=(0,a.getNullLogger)()),e){case"cookie":return function(e){return{type:e,getTrackedActivity:function(e,t,i){var r=t.visit,o=t.visitor,s=t.logger,c=void 0===s?(0,a.getNullLogger)():s,u=new n.TrackedActivityResults(r,o);return"sitecore"!==e||c.error("Sitecore context reader - Context reader not implemented.",{source:e,type:this.type}),u}}}(e);case"js":return{type:"js",getTrackedActivity:function(e,t,i){var r,o=t.url,s=t.context,d=t.visit,l=t.visitor,f=t.date,v=t.logger,g=void 0===v?(0,a.getNullLogger)():v,p=new n.TrackedActivityResults(d,l);if("sitecore"!==e)return p;var h=null!==(r=null==s?void 0:s.tracking)&&void 0!==r?r:{};return g.debug("JS context reader - Reading tracking activity from context.",{tracking:h,context:s,settings:i}),u(c(o,h),f,p,null!=i?i:{},g),p}};case"jss":return{type:"jss",getTrackedActivity:function(e,t,i){var r,o=t.url,s=t.context,d=t.visit,l=t.visitor,f=t.date,v=t.logger,g=void 0===v?(0,a.getNullLogger)():v,p=new n.TrackedActivityResults(d,l);if("sitecore"!==e)return p;var h=null!==(r=function(e,t){var i,r,n=e.context;return(null===(r=null===(i=null==n?void 0:n.sitecore)||void 0===i?void 0:i.context)||void 0===r?void 0:r.tracking)?(t.debug("JSS context reader - Tracking data retrieved from context.sitecore.context.tracking.",n),n.sitecore.context.tracking):(null==n?void 0:n.tracking)?(t.debug("JSS context reader - Tracking data retrieved from context.tracking.",n),n.tracking):n?(t.debug("JSS context reader - Tracking data retrieved from context.",n),n):void 0}(t,g))&&void 0!==r?r:{};return g.debug("JSS context reader - Reading tracking activity from context.",{tracking:h,context:s,settings:i}),u(c(o,h),f,p,null!=i?i:{},g),p}};case"default":case"uniform":break;default:t.info("Sitecore context reader - The specified Sitecore context reader type is not supported. The default type will be used.",{source:e})}return{type:"uniform",getTrackedActivity:function(e,t,i){var r=t.url,o=t.context,s=t.visit,d=t.visitor,l=t.date,f=t.logger,v=void 0===f?(0,a.getNullLogger)():f,g=new n.TrackedActivityResults(s,d);if("sitecore"!==e)return g;var p=o.tracking;return v.debug("Uniform context reader - Reading tracking activity from context.",{tracking:p,context:o,settings:i}),u(c(r,p),l,g,null!=i?i:{},v),g}}}},{"../../models/trackedActivity":140,"./patternMatchers":127,"./scoring":129,"@uniformdev/common":67}],121:[function(e,t,i){"use strict";i.__esModule=!0,i.defaultGetCookieValueFromVisitor=i.defaultGetCookieValueFromVisit=i.defaultGetCookieName=void 0;var r=e("../../models/visitor"),n=e("./activities"),o=e("./tracker"),a=e("../../trackers/tracker"),s=e("@uniformdev/common");i.defaultGetCookieName=function(e){switch(e){case"campaign":return o.SitecoreCookieNames.Campaign;case"campaigns":return o.SitecoreCookieNames.Campaigns;case"goals":return o.SitecoreCookieNames.Goals;case"patterns":return o.SitecoreCookieNames.PatternMatches;case"profiles":return o.SitecoreCookieNames.ProfileScores;case"visitCount":return a.UniformCookieNames.VisitCount}};i.defaultGetCookieValueFromVisit=function(e,t,i,o){i||(i=(0,s.getNullLogger)());var a=(0,r.getCurrentVisit)(t);if(a){switch(e){case"campaign":return u([a],i,o);case"campaigns":return d((0,n.getVisitActivities)("campaign",a,i,o));case"goals":return d((0,n.getVisitActivities)("goal",a,i,o));case"patterns":return l(a);case"profiles":return f(a)}return{unsupportedCookieType:!0}}};function c(e,t){if(e){var i=[];return Object.keys(e).forEach((function(r){var n=t(e[r]);n&&i.push("".concat(r,"=").concat(n))})),i.join(",")}}function u(e,t,i){var r=[];return e.forEach((function(e){var n,o,a=e.data.campaign;if(a){var s=null===(o=null===(n=e.data.campaign)||void 0===n?void 0:n.data)||void 0===o?void 0:o.id;s?r.includes(s)||r.push(s):t.debug("".concat(i," - Campaign was found on the visit but no id is set, so unable to include this campaign in the cookie value."),{campaign:a,visit:e.id,visitor:e.visitorId})}})),{value:r.join(",")}}function d(e){return{value:c(e,(function(e){return e.map((function(e){return e.getTime()})).join("|")}))}}function l(e){var t;return{value:c(null===(t=e.data.patterns)||void 0===t?void 0:t.data,(function(e){return e.patternId}))}}function f(e){var t;return{value:c(null===(t=e.data.profiles)||void 0===t?void 0:t.data,(function(e){if(e.keys){var t=[];if(Object.keys(e.keys).forEach((function(i){var r,n,o=null!==(n=null===(r=e.keys[i])||void 0===r?void 0:r.value)&&void 0!==n?n:0;o>0&&t.push("".concat(i,"_").concat(o))})),t.length>0)return t.join("|")}}))}}i.defaultGetCookieValueFromVisitor=function(e,t,i,r){var o,a;switch(i||(i=(0,s.getNullLogger)()),e){case"campaign":return u(t.visits,i,r);case"campaigns":return d((0,n.getVisitorActivities)("campaign",t,i,r));case"goals":return d((0,n.getVisitorActivities)("goal",t,i,r));case"patterns":return l(t);case"profiles":return f(t);case"visitCount":return{value:null!==(a=null===(o=t.visits)||void 0===o?void 0:o.length)&&void 0!==a?a:0}}}},{"../../models/visitor":143,"../../trackers/tracker":161,"./activities":119,"./tracker":130,"@uniformdev/common":67}],122:[function(e,t,i){"use strict";i.__esModule=!0,i.XdbDestination=void 0;var r=function(e){this.type="xdb",Object.assign(this,e)};i.XdbDestination=r},{}],123:[function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};i.__esModule=!0,i.XdbDispatcher=void 0;var n=r(e("axios")),o=e("./xdbEventConverter"),a=function(){function e(e){this.requiresBrowser=!0,this.type="xdb",this.endpoints=null==e?void 0:e.endpoints,this.httpHeaders=null==e?void 0:e.httpHeaders,this.queryStringParameters=null==e?void 0:e.queryStringParameters}return e.prototype.dispatchActivity=function(e,t,i){var r,a=this,c=(0,o.getXdbTrackedActivityConverterForSitecore)();if(t.event){i.info("xDB dispatcher - Activity was dispatched in event mode.",{activities:e.visitActivities,settings:t});var u=null===(r=this.endpoints)||void 0===r?void 0:r.event;return u?void e.visitActivities.forEach((function(e){var r=c.convert(e);r?function(e,t,i,r,o,a){var c=t.url;r&&(c=s(c,r));var u={data:e,headers:i,method:t.method,withCredentials:!0},d={url:c,config:u},l=o.onBeforeDispatchData;if(l&&!(d=l("xdb",d,a)))return void a.debug("xDB dispatcher dispatcher - Cancelling dispatch because no event data is available.",{originalData:{url:c,config:u}});a.debug("xDB dispatcher - Sending request to Uniform endpoint.",{url:c,method:t.method,pageEvent:e}),(0,n.default)(d.url,d.config).then((function(e){return a.debug("xDB dispatcher - Response received after sending request to Uniform endpoint.",{response:e,endpoint:t,requestModifications:{httpHeaders:i,queryStringParameters:r,settings:o}})})).catch((function(e){return a.error("xDB dispatcher - Error sending request to Uniform endpoint.",{url:c,endpoint:t,requestModifications:{httpHeaders:i,queryStringParameters:r},err:e,settings:o})}))}(r,u,a.httpHeaders,a.queryStringParameters,t,i):i.error("xDB dispatcher - Activity was not converted into a page event, so unable to dispatch activity.",{activity:e})})):void i.error("xDB dispatcher - No event endpoint is specified, so unable to dispatch activities.",{endpoints:this.endpoints,activities:e.visitActivities})}e.visitActivities.filter((function(e){return"page view"===e.type})).forEach((function(e){var r,o=null===(r=e.data)||void 0===r?void 0:r.url;o?function(e,t,i,r,o){i&&(e=s(e,i));t||(t={});t["X-Referer"]=document.referrer;var a={method:"GET",headers:t,withCredentials:!0},c={url:e,config:a},u=r.onBeforeDispatchData;if(u&&!(c=u("xdb",c,o)))return void o.debug("xDB dispatcher dispatcher - Cancelling dispatch because no event data is available.",{originalData:{url:e,config:a}});(0,n.default)(c.url,c.config).then((function(e){return o.debug("xDB dispatcher - Response received after sending request to Sitecore CD instance.",{response:e,requestModifications:{httpHeaders:t,queryStringParameters:i,settings:r}})})).catch((function(n){return o.error("xDB dispatcher - Error sending request to Sitecore CD instance.",{url:e,requestModifications:{httpHeaders:t,queryStringParameters:i},err:n,settings:r})}))}(o,a.httpHeaders,a.queryStringParameters,t,i):i.error("xDB dispatcher - No url is set on the page view activity, so unable to dispatch.",{activity:e,settings:t})}))},e}();function s(e,t){if(!t)return e;var i=new URL(e),r=Object.keys(t).map((function(e){var i=t[e];return"".concat(e,"=").concat(i)})).join("&"),n=i.href;return i.search||(n+="?"),n+=r}i.XdbDispatcher=a},{"./xdbEventConverter":131,axios:1}],124:[function(e,t,i){"use strict";function r(e,t){return{event_category:e,event_data:"".concat(t.data.name,"|").concat(t.data.points)}}i.__esModule=!0,i.getGa4TrackedActivityConverterForSitecore=void 0,i.getGa4TrackedActivityConverterForSitecore=function(){return{type:"default",convert:function(e){switch(e.type){case"page view":return function(e,t){return{event_category:e,event_data:"".concat(t.data.item.id,"|").concat(t.data.item.name)}}("Sitecore Page View",e);case"page event":return r("Sitecore Event",e);case"goal":return r("Sitecore Goal",e);case"personalization":return function(e,t){var i=t.data.page.name,r=t.data.component.name,n=t.data.rule.name,o=t.data.isIncludedInTest?1:0;return{event_category:e,event_data:"".concat(i,"|").concat(r,"|").concat(n,"|").concat(o)}}("Uniform Personalization",e);default:return}}}}},{}],125:[function(e,t,i){"use strict";function r(e,t){return{category:e,action:t.data.name,label:void 0,value:t.data.points}}i.__esModule=!0,i.getGaTrackedActivityConverterForSitecore=void 0,i.getGaTrackedActivityConverterForSitecore=function(){return{type:"default",convert:function(e){switch(e.type){case"page view":return function(e,t){return{category:e,action:t.data.item.id,label:t.data.item.name,value:0}}("Sitecore Page View",e);case"page event":return r("Sitecore Event",e);case"goal":return r("Sitecore Goal",e);case"personalization":return function(e,t){var i,r,n,o,a=null===(r=null===(i=null==t?void 0:t.data)||void 0===i?void 0:i.page)||void 0===r?void 0:r.name,s=null===(o=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.component)||void 0===o?void 0:o.name;return{category:e,action:"".concat(a,"|").concat(s),label:t.data.rule.name,value:t.data.isIncludedInTest?1:0}}("Uniform Personalization",e);default:return}}}}},{}],126:[function(e,t,i){"use strict";function r(e){var t,i=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.name;if(i)return{events:i}}i.__esModule=!0,i.getOracleDmpTrackedActivityConverterForSitecore=void 0,i.getOracleDmpTrackedActivityConverterForSitecore=function(){return{type:"default",convert:function(e){switch(e.type){case"page view":return function(e){var t,i,r,n,o=null===(i=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.item)||void 0===i?void 0:i.id,a=null===(n=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.item)||void 0===n?void 0:n.name;return{itemId:o,itemName:a}}(e);case"campaign":return function(e){var t,i=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.name;if(!i)return;return{campaigns:i}}(e);case"page event":case"goal":return r(e);case"personalization":default:return}}}}},{}],127:[function(e,t,i){"use strict";i.__esModule=!0,i.getPatternMatcher=void 0;var r=e("./scoring");i.getPatternMatcher=function(e){return new n(null!=e?e:o)};var n=function(){function e(e){this.getDistance=e}return e.prototype.match=function(e,t){if(e&&t)return function(e,t,i){var n=null==t?void 0:t.patterns;if(!n)return;if(!e.find((function(e){return e>0})))return;var o,a=void 0,s=0;if(Object.keys(n).forEach((function(c){var u=n[c],d=(0,r.getNormalizedScores)(u.keys,t.keys),l=Object.keys(d).map((function(e){return d[e]})),f=i(e,l);(s>f||null==a)&&(s=f,a=c,o=u)})),!a)return;return{name:null==o?void 0:o.name,patternId:a,distance:s}}(Object.keys(e).map((function(t){return e[t]})),t,this.getDistance)},e}();function o(e,t){var i,r=0;for(i=0;i<e.length;i++)r+=Math.pow(e[i]-t[i],2);return Math.sqrt(r)}},{"./scoring":129}],128:[function(e,t,i){"use strict";i.__esModule=!0},{}],129:[function(e,t,i){"use strict";function r(){return function(e,t,i,r){var n=a(e,i.keys),o=!1;return Object.keys(i.keys).forEach((function(e){var t=i.keys[e];0!=t.value&&(o=!0),n[e]+=t.value})),{profileId:t,keys:n,updateCount:r+1,scoresChanged:o}}}function n(){return function(e,t,i,r){var n=a(e,i.keys),o=!1;return Object.keys(i.keys).forEach((function(e){var t=i.keys[e];0!=t.value&&(o=!0),n[e]=(n[e]*r+t.value)/(r+1)})),{profileId:t,keys:n,updateCount:r+1,scoresChanged:o}}}function o(){return function(e,t,i,r){var n=0;Object.keys(i.keys).forEach((function(e){var t=i.keys[e];n+=t.value}));var o=a(e,i.keys),s=n>0?r+1:r,c=!1;return n>0&&Object.keys(i.keys).forEach((function(e){var t=i.keys[e];0!=t.value&&(c=!0),o[e]=(o[e]*r+t.value/n)/s})),{profileId:t,keys:o,updateCount:s,scoresChanged:c}}}function a(e,t){var i={};return Object.keys(t).forEach((function(t){var r,n=null!==(r=e[t])&&void 0!==r?r:0;i[t]=n})),i}i.__esModule=!0,i.getNormalizedScores=i.getScorerPercentage=i.getScorerAverage=i.getScorerSum=i.getScorer=void 0,i.getScorer=function(e){switch(e){case"Average":return n();case"Sum":return r();case"Percentage":return o();default:return}},i.getScorerSum=r,i.getScorerAverage=n,i.getScorerPercentage=o,i.getNormalizedScores=a},{}],130:[function(e,t,i){"use strict";i.__esModule=!0,i.getSitecoreTracker=i.SitecoreCookieNames=void 0;var r=e("@uniformdev/common"),n=e("./contextReaders"),o=e("../../decay"),a=e("../../trackers");function s(e,t){var i,r=(0,n.getSitecoreContextReader)(null!==(i=e.type)&&void 0!==i?i:"default",t),o=new Map;return o.set(n.CONTEXT_SOURCE_SITECORE,[r]),o}!function(e){e.Campaign="UNIFORM_TRACKER_SITECORE_campaign",e.Campaigns="UNIFORM_TRACKER_SITECORE_campaigns",e.Goals="UNIFORM_TRACKER_SITECORE_goals",e.PatternMatches="UNIFORM_TRACKER_SITECORE_pattern_matches",e.ProfileScores="UNIFORM_TRACKER_SITECORE_profile_scores"}(i.SitecoreCookieNames||(i.SitecoreCookieNames={})),i.getSitecoreTracker=function(e,t){if(t||(t=(0,r.getNullLogger)()),function(e,t){if(1!=e.doNotIncludeDefaultContextReaders){t.debug("getSitecoreTracker - Adding default context readers.",e);var i=s(e,t);i?e.contextReaders?(Array.from(i.keys()).forEach((function(t){var r,n,o=null!==(r=i.get(t))&&void 0!==r?r:[];if(0!=o.length){var a=null!==(n=e.contextReaders.get(t))&&void 0!==n?n:[];o.forEach((function(e){-1!=(null==a?void 0:a.findIndex((function(t){return t.type==e.type})))&&a.push(e)})),e.contextReaders.set(t,a)}})),e.contextReaders=s(e,t)):e.contextReaders=i:t.debug("getSitecoreTracker - No default default context readers were retrieved.",e)}else t.debug("getSitecoreTracker - Will not add default context readers.",e)}(e,t),e.contextReaders)return t.debug("getSitecoreTracker - Context reader(s) resolved for Sitecore tracker.",e.contextReaders),t.debug("getSitecoreTracker - Using Sitecore profile decay settings.",e.decay),e.extensions={onNewVisitCreated:function(t,i,r,n,a){var s,c,u=null===(s=null===window||void 0===window?void 0:window.document)||void 0===s?void 0:s.referrer;(n.data.referrer=u,a.debug("Sitecore tracker extensions - New visit created, so set referrer.",{referrer:u}),r)&&function(e,t,i,r,n,a){var s,c;if(!r)return;if(!n)return void a.error("Sitecore tracker extensions - Cannot copy profiles to new visit when no new visit is provided.",{oldVisitId:r.id});a.debug("Sitecore tracker extensions - New visit created, so apply profiles from the old visit.",{date:t,visitorId:i.id,oldVisit:r,newVisit:n});var u=null===(c=null===(s=r.data)||void 0===s?void 0:s.profiles)||void 0===c?void 0:c.data;if(!u)return void a.debug("Sitecore tracker extensions - No profile data is set on the old visit, so there are no profiles to copy.",{oldVisitId:r.id,newVisitId:n.id});var d=(0,o.getDifferenceAsTimeIncrements)(r.updated,n.updated,e,a);a.debug("Sitecore tracker extensions - Profile decay values were determined.",{unit:e.timeUnit,increments:d});var l=function(e,t,i,r){var n={};return Object.keys(e).forEach((function(a){var s,c=e[a],u={},d=!1;Object.keys(c.keys).forEach((function(e){var n,a=c.keys[e],s=JSON.parse(JSON.stringify(a));s.value=(0,o.doDecay)(null!==(n=s.value)&&void 0!==n?n:0,t,i,r),!d&&s.value>0&&(d=!0),u[e]=s}));var l=(0,o.doDecay)(null!==(s=c.updateCount)&&void 0!==s?s:0,t,i,r);d&&0==l&&(r.debug("Sitecore tracker extensions - After decay was applied, the update count for the profile was zero. But since the decayed profile still has values, the update count will be set to one.",{profile:a,keys:u}),l=1),n[a]={keys:u,name:c.name,updateCount:(0,o.doDecay)(c.updateCount,t,i,r)}})),n}(u,d,e,a);a.debug("Sitecore tracker extensions - Decayed profile was determined.",{withDecay:l,withoutDecay:u}),n.data||(n.data={});n.data.profiles&&a.debug("Sitecore tracker extensions - The current profiles on the new visit will be replaced with decayed profile from the old visit.",{newVisitId:n.id,current:n.data.profiles});a.debug("Sitecore tracker extensions - The decayed profiles from the old visit will be applied to the new visit.",{oldVisitId:r.id,newVisitId:n.id,decay:e,differenceForDecay:d,newProfiles:l});var f={data:l,date:t.toISOString()};if(f.date=t.toISOString(),n.data.profiles=f,!i)return void a.debug("Sitecore tracker extensions - No visitor was specified so the decayed profiles cannot be assigned to the visitor.",{visitorId:r.visitorId,newProfiles:f});i.data||(i.data={});a.debug("Sitecore tracker extensions - The decayed profiles from the old visit will be applied to visitor.",{oldVisitId:r.id,visitorId:i.id,decay:e,differenceForDecay:d,newProfiles:l}),i.data.profiles=JSON.parse(JSON.stringify(f))}(null!==(c=e.decay)&&void 0!==c?c:(0,o.getDefaultDecaySettings)(),t,i,r,n,a)}},(0,a.getDefaultTracker)(e,{logger:t});t.error("getSitecoreTracker - No context readers were resolved for the Sitecore tracker. Without a context reader, the tracker is unable to read trackable data. The null tracker will be used. This tracker does not track anything; it simply writes to the log.",e)}},{"../../decay":134,"../../trackers":158,"./contextReaders":120,"@uniformdev/common":67}],131:[function(e,t,i){"use strict";i.__esModule=!0,i.getXdbTrackedActivityConverterForSitecore=void 0,i.getXdbTrackedActivityConverterForSitecore=function(){return{type:"default",convert:function(e){switch(e.type){case"page event":case"goal":return function(e){return{date:e.date,pageEventId:e.data.id}}(e);default:return}}}}},{}],132:[function(e,t,i){"use strict";i.__esModule=!0},{}],133:[function(e,t,i){"use strict";i.__esModule=!0,i.getMaxExpirationDate=i.removeCookie=i.getCookie=i.setCookie=void 0,i.setCookie=function(e,t,i){var r="";if(i){var n=new Date;n.setTime(n.getTime()+24*i*60*60*1e3),r="; expires="+n.toUTCString()}document.cookie=e+"="+(t||"")+r+"; path=/"},i.getCookie=function(e){for(var t=e+"=",i=document.cookie.split(";"),r=0;r<i.length;r++){for(var n=i[r];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}},i.removeCookie=function(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"},i.getMaxExpirationDate=function(){var e=new Date;return e.setTime(e.getTime()+31536e7),e}},{}],134:[function(e,t,i){"use strict";i.__esModule=!0,i.getDifferenceAsTimeIncrements=i.doDecay=i.getDefaultDecaySettings=void 0;function r(e){return"string"==typeof e?new Date(e):e}i.getDefaultDecaySettings=function(){return{rate:3,round:"default",timeUnit:"default",timeIncrement:1,type:"default"}},i.doDecay=function(e,t,i,r){return e<=0||t<=0?0:function(e,t,i){void 0===t&&(t="default");switch(t){case"none":return e;case"down":return Math.floor(e);case"up":return Math.ceil(e);case"closest":case"default":break;default:i.error("The specified rounding option is not supported. Default rounding will be used.",{value:e,rounding:t})}return Math.round(e)}(e*function(e,t,i,r){void 0===t&&(t="default");void 0===i&&(i=3);switch(t){case"compound":return Math.pow(1-i/100,e);case"simple":case"default":return 1-i/100*e;default:r.error("The specified decay type is not supported. No decay will be used.",{type:t})}return 1}(t,i.type,i.rate,r),i.round,r)},i.getDifferenceAsTimeIncrements=function(e,t,i,n){var o,a,s=0;switch(null!==(o=i.timeUnit)&&void 0!==o?o:"default"){case"seconds":s=1e3;break;case"minutes":s=6e4;break;case"hours":s=36e5;break;case"days":case"default":s=864e5;break;default:n.error("The specified decay unit is not supported. No decay will be used.",{settings:i})}if(0==s)return 0;var c=function(e,t){return r(t).getTime()-r(e).getTime()}(e,t),u=Math.abs(c/s),d=null!==(a=i.timeIncrement)&&void 0!==a?a:1;return Math.floor(u/d)}},{}],135:[function(e,t,i){"use strict";i.__esModule=!0},{}],136:[function(e,t,i){"use strict";i.__esModule=!0},{}],137:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};i.__esModule=!0,n(e("./destination"),i),n(e("./dispatcher"),i)},{"./destination":135,"./dispatcher":136}],138:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};i.__esModule=!0,i.getDefaultDecaySettings=void 0,n(e("./contextReader"),i),n(e("./connectors/index"),i);var o=e("./decay");r(i,o,"getDefaultDecaySettings"),n(e("./dispatchers"),i),n(e("./models/index"),i),n(e("./repositories"),i),n(e("./storage"),i),n(e("./trackers"),i),n(e("./cookies"),i)},{"./connectors/index":115,"./contextReader":132,"./cookies":133,"./decay":134,"./dispatchers":137,"./models/index":139,"./repositories":145,"./storage":148,"./trackers":158}],139:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};i.__esModule=!0,n(e("./visit"),i),n(e("./visitor"),i),n(e("./trackedActivity"),i),n(e("./utils"),i)},{"./trackedActivity":140,"./utils":141,"./visit":142,"./visitor":143}],140:[function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});i.__esModule=!0,i.QUEUE_ENTRY_TYPE_TRACKER=i.TrackedActivityResults=i.VisitorUpdate=i.VisitUpdate=i.VisitActivity=i.TrackedActivity=void 0;var o=function(e,t,i){this.type=e,this.date=t,Object.assign(this,i)};i.TrackedActivity=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o);i.VisitActivity=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o);i.VisitUpdate=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(o);i.VisitorUpdate=c;var u=function(){function e(e,t){this.visitUpdates=[],this.visitUpdateCommands=[],this.visitorUpdates=[],this.visitorUpdateCommands=[],this.visitActivities=[],this.visit=e,this.visitor=t}return e.prototype.append=function(e){var t=this;e&&(e.visitActivities.forEach((function(e){return t.visitActivities.push(e)})),e.visitUpdates.forEach((function(e){return t.visitUpdates.push(e)})),e.visitUpdateCommands.forEach((function(e){return t.visitUpdateCommands.push(e)})),e.visitorUpdates.forEach((function(e){return t.visitorUpdates.push(e)})),e.visitorUpdateCommands.forEach((function(e){return t.visitorUpdateCommands.push(e)})))},e}();i.TrackedActivityResults=u,i.QUEUE_ENTRY_TYPE_TRACKER="tracker"},{}],141:[function(e,t,i){"use strict";i.__esModule=!0,i.getActiveVisits=i.getLatestVisit=i.appendTrackedActivityResults=void 0,i.appendTrackedActivityResults=function(e,t){e&&(e.visitActivities.forEach((function(e){return t.visitActivities.push(e)})),e.visitUpdates.forEach((function(e){return t.visitUpdates.push(e)})),e.visitorUpdates.forEach((function(e){return t.visitorUpdates.push(e)})))},i.getLatestVisit=function(e){for(var t=void 0,i=0;i<e.visits.length;i++){var r=e.visits[i];r.end||(!t||r.updated>t.updated)&&(t=r)}return t},i.getActiveVisits=function(e){for(var t=[],i=0;i<e.visits.length;i++){var r=e.visits[i];r.end||t.push(r)}return t}},{}],142:[function(e,t,i){"use strict";i.__esModule=!0,i.Visit=void 0;var r=new Date(0).toISOString(),n=function(e,t,i,n){this.updated=r,this.id=e,this.visitorId=t,this.start=i,Object.assign(this,n)};i.Visit=n},{}],143:[function(e,t,i){"use strict";i.__esModule=!0,i.addVisits=i.getCurrentVisit=i.Visitor=void 0;var r=e("../trackers/utils"),n=new Date(0).toISOString(),o=function(e,t){this.updated=n,this.visits=[],this.id=e,Object.assign(this,t)};i.Visitor=o,i.getCurrentVisit=function(e){if(null==e?void 0:e.visits){var t=e.visits.filter((function(e){return!e.end}));if(0==t.length)return;return 1==t.length?t[0]:t.reduce((function(e,t){return new Date(e.start)>new Date(t.start)?e:t}))}},i.addVisits=function(e,t){if(e&&t){var i=[];if(e.forEach((function(e){-1==t.visits.findIndex((function(t){return t.id==e.id}))&&i.push(e)})),i.length>0)return i.forEach((function(e){return t.visits.push(e)})),(0,r.getVisitChangesFromVisits)(e,t)}return new Map}},{"../trackers/utils":162}],144:[function(e,t,i){"use strict";i.__esModule=!0,i.getTrackingDataRepository=void 0;var r=e("../models/visitor"),n=e("../models/utils"),o=e("@uniformdev/common"),a=e("uuid");i.getTrackingDataRepository=function(e,t){return new s(e,null==t?void 0:t.subscriptions,null==t?void 0:t.logger)};var s=function(){function e(e,t,i){this.type="default",this.logger=null!=i?i:(0,o.getNullLogger)(),this.storageProvider=e,this.subscriptions=t}return e.prototype.getNewVisitId=function(){return(0,a.v4)()},e.prototype.getNewVisitorId=function(){return(0,a.v4)()},e.prototype.getCurrentVisit=function(e){var t,i=this,r=e.visitor,o=e.visitId,a=e.sessionTimeout,s=e.forceNew,c=void 0!==s&&s,u=e.when,d=u&&u.getTime()>0?u:new Date,l=(0,n.getActiveVisits)(r);if((null==l?void 0:l.length)>0){var f,v=[],g=[];if(l.forEach((function(e){var r=function(e,t){"string"==typeof e&&(e=new Date(e));return new Date(e.getTime()+1e3*t*60)}(e.updated,a);if(d>=r)return e.end=r.toISOString(),v.push(e),void(e.id==o&&(t=e));if(!o||e.id!=o||c)return e.end=e.updated,void g.push(e);f=e;var n=function(e,t){"string"==typeof e&&(e=new Date(e));"string"==typeof t&&(t=new Date(t));var i=e.getTime()-t.getTime(),r=i%1e3,n=Math.floor(i/1e3%60),o=Math.floor(i/1e3/60%60),a=Math.floor(i/1e3/60/60%60),s=Math.floor(i/1e3/60/60/24);return{diff:i,milliseconds:r,seconds:n,minutes:o,hours:a,days:s}}(r,d);i.logger.debug("Default tracking data repository - Current visit is still active.",{ttl:n,visit:e,now:d,end:r})})),(g.length>0||v.length>0)&&this.saveVisitorNoUpdate(r),g.forEach((function(e){i.logger.debug("Default tracking data repository - Visit ended.",e),i.subscriptions&&i.subscriptions.publish({type:"visit-end",when:d,visit:e,visitor:r})})),v.forEach((function(e){i.logger.debug("Default tracking data repository - Visit timed out.",e),i.subscriptions&&i.subscriptions.publish({type:"visit-timeout",when:d,visit:e,visitor:r})})),f)return{current:f,previous:void 0,isNewVisit:!1}}var p=this.addVisit(r,d);return this.subscriptions&&this.subscriptions.publish({type:"visit-created",when:new Date,visit:p,visitor:r}),{current:p,previous:t,isNewVisit:!0}},e.prototype.getVisitor=function(e){if(this.storageProvider){if(null!=e&&""!=e){var t=this.storageProvider.read(e,this.logger);if(t)return t}}else this.logger.error("Default tracking data repository - No storage provider is available, so unable to get data for visitor "+e)},e.prototype.createVisitor=function(){return this.doCreateVisitor(this.getNewVisitorId())},e.prototype.doCreateVisitor=function(e){var t=new Date,i=new r.Visitor(e,{updated:t.toISOString()});return this.storageProvider.write(i,this.logger),this.logger.debug("Default tracking data repository - New visitor created.",{visitor:i}),this.subscriptions&&this.subscriptions.publish({type:"visitor-created",when:new Date,visitor:i}),i},e.prototype.saveVisitorNoUpdate=function(e){this.storageProvider.write(e),this.logger.debug("Default tracking data repository - Visitor saved to the repository but no update events were fired.",e)},e.prototype.saveVisitor=function(e,t,i,r,n){if(t.updated=e.toISOString(),this.storageProvider.write(t),this.logger.debug("Default tracking data repository - Visitor saved to the repository.",{visitor:t}),this.subscriptions)if(!0!==n){var o=new Date;i&&i.size>0&&this.subscriptions.publish({type:"visit-updated",when:o,changes:i,visitor:t}),r&&r.length>0&&this.subscriptions.publish({type:"visitor-updated",when:o,changes:r,visitor:t})}else this.logger.debug("Default tracking data repository - Visitor saved in silent mode, so no events will be published.",{visitor:t})},e.prototype.addVisit=function(e,t){var i=t.toISOString();e.updated=i;var r={id:this.getNewVisitId(),visitorId:e.id,start:i,updated:i,data:{}};return this.logger.debug("Default tracking data repository - New visit created.",r),e.visits||(e.visits=[]),e.visits.push(r),this.storageProvider.write(e),r},e}()},{"../models/utils":141,"../models/visitor":143,"@uniformdev/common":67,uuid:33}],145:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};i.__esModule=!0,n(e("./defaultRepository"),i),n(e("./repository"),i)},{"./defaultRepository":144,"./repository":146}],146:[function(e,t,i){"use strict";i.__esModule=!0},{}],147:[function(e,t,i){"use strict";i.__esModule=!0;var r=e("./localStorage");i.default=function(e,t,i){switch(e){case"custom":var n=t?t():void 0;return n||i.error("When the custom storage provider type is specified, getCustomProvider must return a provider.",{storage:e}),n;case"default":case"local":break;default:i.error("The storage option specified for the tracker is not supported. Default storage provider will be used.",{storage:e})}return new r.LocalStorageProvider}},{"./localStorage":149}],148:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};i.__esModule=!0,n(e("./provider"),i),n(e("./getStorageProvider"),i)},{"./getStorageProvider":147,"./provider":150}],149:[function(e,t,i){"use strict";i.__esModule=!0,i.LocalStorageProvider=void 0;var r=function(){function e(){}return e.prototype.read=function(e,t){if(e){var i=localStorage.getItem(e);if(i)return JSON.parse(i)}},e.prototype.write=function(e,t){e&&e.id&&localStorage.setItem(e.id,JSON.stringify(e))},e}();i.LocalStorageProvider=r},{}],150:[function(e,t,i){"use strict";i.__esModule=!0,i.getStorageProvider=void 0;var r=e("./localStorage");i.getStorageProvider=function(e,t,i){switch(e){case"custom":var n=t?t():void 0;return n||i.error("When the custom storage provider type is specified, getCustomProvider must return a provider.",{storage:e}),n;case"default":case"local":break;default:i.error("The storage option specified for the tracker is not supported. Default storage provider will be used.",{storage:e})}return new r.LocalStorageProvider}},{"./localStorage":149}],151:[function(e,t,i){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var i,r,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};i.__esModule=!0,i.DefaultTracker=void 0;var a=e("./utils"),s=e("../models/trackedActivity"),c=e("@uniformdev/common"),u=e("@uniformdev/optimize-common-sitecore"),d=e("../build/version.json"),l=function(){function e(e,t){var i,r,n,o,a;this.contextReaders=new Map,this.state="unknown",this.id=e,this.contextReaders=null!==(i=t.contextReaders)&&void 0!==i?i:new Map,this.dispatchers=null!==(r=t.dispatchers)&&void 0!==r?r:[],this.onDispatch=t.onDispatch,this.onBeforeDispatchData=t.onBeforeDispatchData,this.logger=null!==(n=t.logger)&&void 0!==n?n:(0,c.getNullLogger)(),this.extensions=t.extensions,this.repository=t.repository,this.sessionTimeout=null!==(o=t.sessionTimeout)&&void 0!==o?o:20,this.subscriptions=null!==(a=t.subscriptions)&&void 0!==a?a:(0,u.getSubscriptionManager)("".concat(e,"_SUBS"),!1,this.logger),this.version=d.version}return e.prototype.event=function(e,t,i){return n(this,void 0,void 0,(function(){var n,a,s=this;return o(this,(function(o){switch(o.label){case 0:return this.logger.debug("Default tracker - START: event() handling.",{event:t,settings:i}),n=function(i,r){switch(e){case"visit-activity":r.visitActivities.push(t);break;case"visit-update":r.visitUpdates.push(t);break;case"visitor-update":r.visitorUpdates.push(t);break;default:s.logger.error("Default tracker - Specified event type is not supported. Event will not be captured.",{type:e,event:t})}},[4,this.doWork("tracking-finished",r(r({},i),{event:!0}),n)];case 1:return a=o.sent(),this.logger.debug("Default tracker - END: event() handling.",{results:a}),[2,a]}}))}))},e.prototype.initialize=function(e){return n(this,void 0,void 0,(function(){var t;return o(this,(function(i){switch(i.label){case 0:return this.logger.debug("Default tracker - START: initialize() handling.",{settings:e}),[4,this.doWork("tracking-intialized",e,(function(e,t){}))];case 1:return t=i.sent(),this.logger.debug("Default tracker - END: initialize() handling.",{results:t}),[2,t]}}))}))},e.prototype.subscribe=function(e,t){return this.logger.debug("Default tracker - Add subscription.",{manager:this.subscriptions.id,type:e}),this.subscriptions.subscribe(e,t)},e.prototype.track=function(e,t,i){return n(this,void 0,void 0,(function(){var r,n,a=this;return o(this,(function(o){switch(o.label){case 0:return this.logger.debug("Default tracker - START: track() handling.",{source:e,context:t,settings:i}),r=function(i,r){var n=r.visit,o=r.visitor,s=new URL(null===window||void 0===window?void 0:window.location.href);if(e?a.contextReaders.get(e):void 0){var c={date:i,context:t,visit:n,visitor:o,url:s,logger:a.logger};a.logger.debug("Default tracker -   * Iterate context readers to read activity from context.",{context:t}),a.contextReaders.forEach((function(t,i){a.logger.debug("Default tracker -   * Reading activity from context using context readers.",{id:i,readers:t}),t.forEach((function(t){var i=t.getTrackedActivity(e,c);a.logger.debug("Default tracker -      * Activity read from reader.",{type:t.type,activity:i}),r.append(i)}))}))}else a.logger.warn("Default tracker -   * No context readers are registered for the source. No tracking data will be created.",{source:e})},[4,this.doWork("tracking-finished",i,r)];case 1:return n=o.sent(),this.logger.debug("Default tracker - END: track() handling.",{results:n}),[2,n]}}))}))},e.prototype.doDispatch=function(e,t,i){var r=this;if(this.dispatchers&&this.dispatchers.length>0){this.logger.debug("Default tracker -   * Dispatchers are defined, so call them.",{visitorId:i.id,dispatchers:this.dispatchers});var n="undefined"!=typeof window&&null!=window.document;this.dispatchers.forEach((function(o){o.requiresBrowser&&!n||(r.logger.debug("Default tracker -   START: activity dispatch.",{visitorId:i.id,type:o.type,activity:e}),o.dispatchActivity(e,t,r.logger),r.logger.debug("Default tracker -   END: activity dispatch.",{visitorId:i.id,type:o.type,activity:e}))}))}this.onDispatch&&(this.logger.debug("Default tracker -   START: dispatch event handler.",{activity:e,settings:t}),this.onDispatch(e,t,this.logger),this.logger.debug("Default tracker -   END: dispatch event handler."))},e.prototype.doVisitUpdate=function(e,t,i){(t.visitActivities.length>0||t.visitUpdates.length>0)&&(i.updated=e),i.data||(i.data={}),i.data.activities||(i.data.activities=[]),0===t.visitActivities.length?this.logger.debug("Default tracker -   * No visit activities to add to visit.",{visit:i,activities:t.visitActivities}):(this.logger.debug("Default tracker -   * Adding visit activities to visit.",{visit:i,activities:t.visitActivities}),t.visitActivities.forEach((function(e){i.data.activities.push(e)})),this.logger.debug("Default tracker -   * Visit activities added to visit.",{visit:i,activities:t.visitActivities})),0===t.visitUpdates.length?this.logger.debug("Default tracker -   * No visit data to add to visit.",{visit:i,data:t.visitUpdates}):(this.logger.debug("Default tracker -   * Apply visit updates.",{visit:i.id,count:t.visitUpdates.length}),this.applyUpdatesToTarget(e,t.visitUpdates,i)),0===t.visitUpdateCommands.length?this.logger.debug("Default tracker -   * No visit update commands to run.",{visit:i.id}):(this.logger.debug("Default tracker -   * Run visit update commands.",{visit:i.id,commands:t.visitUpdateCommands}),t.visitUpdateCommands.forEach((function(e){e(i)})))},e.prototype.doVisitorUpdate=function(e,t,i){i.data||(i.data={}),0===t.visitorUpdates.length?this.logger.debug("Default tracker -   * No visitor updates to apply.",{visitor:i.id}):(this.logger.debug("Default tracker -   * Apply visitor updates.",{visitor:i.id,count:t.visitorUpdates.length}),this.applyUpdatesToTarget(e,t.visitorUpdates,i)),0===t.visitorUpdateCommands.length?this.logger.debug("Default tracker -   * No visitor update commands to run.",{visitor:i.id}):(this.logger.debug("Default tracker -   * Run visitor update commands.",{visitor:i.id,commands:t.visitorUpdateCommands}),t.visitorUpdateCommands.forEach((function(e){e(i)})))},e.prototype.applyUpdatesToTarget=function(e,t,i){var r=this;t.forEach((function(t){r.logger.debug("Default tracker -     * Applying update to target.",{target:i.id,update:t}),i.data[t.type]?(i.data[t.type].date=e,Object.keys(t.data).forEach((function(e){i.data[t.type].data[e]=t.data[e]}))):i.data[t.type]={date:e,data:t.data}}))},e.prototype.doWork=function(e,t,i){var r;return n(this,void 0,void 0,(function(){var n,c,u,d,l,f,v,g,p,h,m,y,b,k,w,_,O,T,x=this;return o(this,(function(o){switch(o.label){case 0:n=t.visitorId,c=t.visitId,u=t.createVisitor,d=void 0!==u&&u,l=t.onVisitorInitialized,f=void 0,v=void 0,g=new s.TrackedActivityResults,p=(new Date).toISOString(),this.logger.debug("Default tracker -   START: doWork.",{eventType:e,settings:t}),o.label=1;case 1:if(o.trys.push([1,4,5,6]),n?(this.logger.debug("Default tracker -   * Get visitor from the repository using visitor id set on the tracking settings.",{visitorId:n}),(f=this.repository.getVisitor(n))||this.logger.debug("Default tracker -   * No visitor was returned from the repository.",{visitorId:n})):this.logger.debug("Default tracker -   * No visitor id was set on the tracking settings, so will try to create new visitor.",{settings:t}),f)this.logger.debug("Default tracker -   * Visitor was retrieved from the repository.",{visitorId:n});else{if(!d)return this.logger.warn("Default tracker -   * No visitor was resolved and the create-visitor flag was not set on the tracking settings. Tracking will abort.",{settings:t}),[2,g];if(!(f=this.repository.createVisitor()))return this.logger.error("Default tracker -   * Unable to create new visitor. Tracking will abort."),[2,g];this.logger.debug("Default tracker -   * New visitor was created.",{visitorId:f.id})}return l?(this.logger.debug("Default tracker -   * Event handler for visitor-initialized event was specified on the tracking settings, so call it."),[4,l(f,(function(e,i,r,n){x.logger.debug("Default tracker - Save visitor was called by the visitor-initialized event handler specified on the tracking settings."),x.repository.saveVisitor(e,i,r,n,null==t?void 0:t.silent)}),this.logger)]):[3,3];case 2:o.sent(),this.logger.debug("Default tracker -   * Event handler for visitor-initialized event specified on the tracking settings finished."),o.label=3;case 3:return h=this.repository.getCurrentVisit({visitId:c,visitor:f,sessionTimeout:this.sessionTimeout,forceNew:t.isNew,when:t.lastActivity?new Date(t.lastActivity):void 0}),(v=h.current)?(h.isNewVisit&&(null===(r=this.extensions)||void 0===r?void 0:r.onNewVisitCreated)&&(this.logger.debug("Default tracker -   * Event handler for new-visit-created event was specified on extensions on the tracking settings, so call it.",{settings:t}),m=new Date,this.extensions.onNewVisitCreated(m,f,h.previous,v,this.logger)),g.visit=v,g.visitor=f,i(p,g),y=(0,a.getVisitChangesFromResults)(g,v,f),this.logger.debug("Default tracker -   * Resolved visit changes from results.",{visitChanges:y,activity:g,visit:v,visitor:f}),b=(0,a.getVisitorChanges)(g,v,f),this.logger.debug("Default tracker -   * Resolved visitor changes from results.",{visitorChanges:b,activity:g,visit:v,visitor:f}),0==y.size&&0==b.length?(this.logger.debug("Default tracker -   * No changes were made to the visit or the visitor, so there is nothing to track.",{activity:g}),[2,g]):(this.doVisitUpdate(p,g,v),this.doVisitorUpdate(p,g,f),k=new Date,this.extensions&&this.extensions.onBeforeVisitorSaved&&(this.logger.debug("Default tracker -   * Event handler for before-visitor-saved event was specified on extensions on the tracking settings, so call it.",{settings:t}),this.extensions.onBeforeVisitorSaved(k,f,y,b,this.logger)),(w=b.length>0||y.size>0)?(this.logger.debug("Default tracker -   START: saving visitor.",{visitorId:f.id,when:k,visitorChanges:b,visitChanges:y}),this.repository.saveVisitor(k,f,y,b,null==t?void 0:t.silent),this.logger.debug("Default tracker -   END: saving visitor.",{visitorId:f.id})):this.logger.debug("Default tracker -   * No visitor or visit changes were resolved, so no changes will be saved to the repository.",{visitor:f.id,visit:v.id}),window.uniform||(this.logger.debug("Default tracker -   * Global Uniform object does not exist, so creating it.",{visit:v,visitor:f}),window.uniform={}),this.logger.debug("Default tracker -   * Updating global Uniform object.",{tracker:this.id,visitor:f.id,visit:v.id}),window.uniform.tracker=this,window.uniform.visit=v,window.uniform.visitor=f,!0!==t.silent?(_={type:e,when:new Date,visit:g.visit,visitor:g.visitor},this.subscriptions.getSubscriptionTypes().includes(_.type)||this.logger.debug("Default tracker -   * An event will be fired, but the subscription manager is not listening for it.",{manager:this.subscriptions.id,event:_,types:this.subscriptions.getSubscriptionTypes()}),this.logger.debug("Default tracker -   * Notify subscribers that tracking is finished.",{manager:this.subscriptions.id,event:_,types:this.subscriptions.getSubscriptionTypes(),settings:t}),this.subscriptions.publish(_)):this.logger.debug("Default tracker -   * Tracking settings indicate silent mode. Tracking is finished but subscribers will not be notified.",{manager:this.subscriptions.id}),w&&(O={event:t.event,onBeforeDispatchData:this.onBeforeDispatchData},this.doDispatch(g,O,f)),[3,6])):(this.logger.error("Default tracker -   * No visit was returned from the repository. Tracking will abort."),[2,g]);case 4:return T=o.sent(),this.logger.error("Default tracker -   * Error thrown.",{ex:T}),[3,6];case 5:return this.logger.debug("Default tracker -   END: doWork.",{settings:t}),this.state="ready",[7];case 6:return[2,g]}}))}))},e}();i.DefaultTracker=l},{"../build/version.json":110,"../models/trackedActivity":140,"./utils":162,"@uniformdev/common":67,"@uniformdev/optimize-common-sitecore":94}],152:[function(e,t,i){"use strict";i.__esModule=!0,i.getDispatchersForGaDestinations=void 0;var r=e("../connectors/ga/dispatcher"),n=e("../connectors/sitecore/gaEventConverter");i.getDispatchersForGaDestinations=function(e,t){var i=t.logger,o=t.loggerPrefix,a=[];return e.forEach((function(e){var s=function(e,t){if(!e)return;var i=t.ga,o=t.logger,a=t.loggerPrefix;if(!i)return void o.debug("".concat(a," - No GA settings were specified on args so no GA dispatch will be performed."),t);var s=i.initializeGa;if(!s)return void o.debug("".concat(a," - No function to initialize GA was specified on args so no GA dispatch will be performed."),t);if(!s(e,o))return void o.debug("".concat(a," - Unable to initialize GA so no GA dispatch will be performed."),e);var c=function(e,t){var i,r=t.logger,o=t.loggerPrefix,a=null!==(i=e.activityConverters)&&void 0!==i?i:[];if(1!=e.doNotUseDefaultActivityConverter){var s=(0,n.getGaTrackedActivityConverterForSitecore)();s&&a.every((function(e){return e.type!=s.type}))&&(a.push(s),r.debug("".concat(o," - Added default GA tracked activity converter for Sitecore."),{converters:a}))}return a}(e,t),u=new r.GaDispatcher(c,e);if(e.mappings){var d=e.mappings,l=function(e,t){d.forEach((function(e){if(e.action){var i=new Function(e.action)();i&&t.set(e.index,i)}}))};u.setCustomDimensionValues=l}return u}(e,t);s?a.push(s):i.error("".concat(o," - Unable to get dispatcher for GA destination."),e)})),a}},{"../connectors/ga/dispatcher":114,"../connectors/sitecore/gaEventConverter":125}],153:[function(e,t,i){"use strict";i.__esModule=!0,i.getDispatchersForGa4Destinations=void 0;var r=e("../connectors/ga4/dispatcher"),n=e("../connectors/sitecore/ga4EventConverter");i.getDispatchersForGa4Destinations=function(e,t){var i=t.logger,o=t.loggerPrefix,a=[];return e.forEach((function(e){var s=function(e,t){if(!e)return;var i=t.ga4,o=t.logger,a=t.loggerPrefix;if(!i)return void o.debug("".concat(a," - No GA4 settings were specified on args so no GA dispatch will be performed."),t);var s=i.initializeGa4;if(!s)return void o.debug("".concat(a," - No function to initialize GA4 was specified on args so no GA4 dispatch will be performed."),t);if(!s(e,o))return void o.debug("".concat(a," - Unable to initialize GA4 so no GA4 dispatch will be performed."),e);var c=function(e,t){var i,r=t.logger,o=t.loggerPrefix,a=null!==(i=e.activityConverters)&&void 0!==i?i:[];if(1!=e.doNotUseDefaultActivityConverter){var s=(0,n.getGa4TrackedActivityConverterForSitecore)();s&&a.every((function(e){return e.type!=s.type}))&&(a.push(s),r.debug("".concat(o," - Added default GA4 tracked activity converter for Sitecore."),{converters:a}))}return a}(e,t);return new r.Ga4Dispatcher(c,e)}(e,t);s?a.push(s):i.error("".concat(o," - Unable to get dispatcher for GA4 destination."),e)})),a}},{"../connectors/ga4/dispatcher":112,"../connectors/sitecore/ga4EventConverter":124}],154:[function(e,t,i){"use strict";i.__esModule=!0,i.getDefaultTracker=void 0;var r=e("../repositories"),n=e("../storage"),o=e("@uniformdev/common"),a=e("./defaultTracker");i.getDefaultTracker=function(e,t){var i,s=null!==(i=null==t?void 0:t.logger)&&void 0!==i?i:(0,o.getNullLogger)(),c=(0,n.getStorageProvider)(e.storage,e.getCustomStorageProvider,s);if(c){var u=(0,r.getTrackingDataRepository)(c,{logger:s,subscriptions:e.subscriptions});if(u){s.debug("Tracker - Using repository type "+u.type,u),!e.sessionTimeout||e.sessionTimeout<0?s.debug("Tracker - Session timeout will be determined by the tracker."):s.debug("Tracker - Session timeout ".concat(e.sessionTimeout," minute(s)."));var d={campaignParameters:e.campaignParameters,contextReaders:e.contextReaders,dispatchers:e.dispatchers,onDispatch:e.onDispatch,onBeforeDispatchData:e.onBeforeDispatchData,extensions:e.extensions,goalParameters:e.goalParameters,logger:s,repository:u,sessionTimeout:e.sessionTimeout,subscriptions:e.subscriptions};return new a.DefaultTracker("TRACKER",d)}s.error("Tracker - No tracking data repository was resolved. This is required in order to create a tracker.",{settings:e})}else s.error("Tracker - No storage provider was resolved. This is required in order to create a tracker.",{settings:e})}},{"../repositories":145,"../storage":148,"./defaultTracker":151,"@uniformdev/common":67}],155:[function(e,t,i){"use strict";i.__esModule=!0},{}],156:[function(e,t,i){"use strict";i.__esModule=!0,i.getDispatchersFromTrackingConfig=void 0;var r=e("@uniformdev/optimize-common-sitecore"),n=e("./ga"),o=e("./ga4"),a=e("./oracleDmp"),s=e("./xdb");i.getDispatchersFromTrackingConfig=function(e,t){var i=t.logger,c=t.loggerPrefix,u=[],d=function(e,t){var i,r=t.logger,n=t.loggerPrefix,o=new Map;if(!e)return r.warn("".concat(n," - No tracking config was specified, so no destinations will be added to the destination map."),{args:t}),o;var a=e.destinations;return null!==(i=null==a?void 0:a.length)&&void 0!==i&&i&&a.forEach((function(e){var t,i=e.type,a=null!==(t=o.get(i))&&void 0!==t?t:[];e.configId&&a.some((function(t){return t.configId==e.configId}))?r.debug("".concat(n," - Destination is included in the tracking data multiple times. It will not be added to the destination map more than once."),e):(a.push(e),o.set(i,a))})),o}(e,{logger:i,loggerPrefix:c});return Array.from(d.keys()).forEach((function(e){var l,f,v,g,p,h=null!==(l=d.get(e))&&void 0!==l?l:[];if(0!=h.length)switch(e){case"ga":if(!t.ga)return void i.error("".concat(c," - GA settings are missing from args so unable to configure GA dispatchers."),t);var m=null!==(f=(0,n.getDispatchersForGaDestinations)(h,t))&&void 0!==f?f:[];return void(m.length>0&&(i.debug("".concat(c," - GA dispatchers were registered."),m),(0,r.appendArray)(m,u)));case"ga4":if(!t.ga4)return void i.error("".concat(c," - GA4 settings are missing from args so unable to configure GA4 dispatchers."),t);var y=null!==(v=(0,o.getDispatchersForGa4Destinations)(h,t))&&void 0!==v?v:[];return void(y.length>0&&(i.debug("".concat(c," - GA4 dispatchers were registered."),y),(0,r.appendArray)(y,u)));case"oracleDmp":var b=null!==(g=(0,a.getDispatchersForOracleDmpDestinations)(h,t))&&void 0!==g?g:[];return void(b.length>0&&(i.debug("".concat(c," - Oracle DMP dispatchers were registered."),b),(0,r.appendArray)(b,u)));case"xdb":var k=null!==(p=(0,s.getDispatchersForXdbDestinations)(h,t))&&void 0!==p?p:[];return void(k.length>0&&(i.debug("".concat(c," - xDB dispatchers were registered."),k),(0,r.appendArray)(k,u)));default:return void i.error("".concat(c," - The specified destination type is not supported."),{type:e,destinations:h.length})}})),u}},{"./ga":152,"./ga4":153,"./oracleDmp":160,"./xdb":163,"@uniformdev/optimize-common-sitecore":94}],157:[function(e,t,i){"use strict";i.__esModule=!0,i.addSubscriptionsForTrackerCookies=i.getTrackerCookieSettings=void 0;var r,n=e("../connectors/sitecore/cookies"),o=e("../cookies");function a(e,t){var i,o,a=t.cookieSettings,c=t.logger,u=t.loggerPrefix,d=t.getCookieName,l=void 0===d?n.defaultGetCookieName:d,f=t.getCookieValueFromVisitor,v=void 0===f?n.defaultGetCookieValueFromVisitor:f,g=t.getCookieValueFromVisit,p=void 0===g?n.defaultGetCookieValueFromVisit:g;if(c.debug("".concat(u," - START: tracking event handler to set tracking cookies."),{type:e.type,e:e,args:t}),!e.visitor)return c.error("".concat(u," -   * No visitor is set on the tracking event. Unable to set tracking cookies."),{e:e,args:t}),void c.debug("".concat(u," - END: tracking event handler to set tracking cookies."),{type:e.type,e:e,args:t});var h=null!==(i=null==a?void 0:a.visitor)&&void 0!==i?i:[];0==h.length?c.debug("".concat(u," -   * No visitor cookie types were specified in the cookie settings, so no visitor tracking cookies will be updated."),{e:e,args:t}):(c.debug("".concat(u," -   START: iterating visitor cookie types."),{visitorCookieTypes:h}),h.forEach((function(i){var n=l(i);if(n){var o=v(i,e.visitor,c,u);c.debug("".concat(u," -     * Cookie value retrieved from visitor."),{cookieValue:o,cookieType:i}),o&&!o.unsupportedCookieType&&s(r.Visitor,o.value,n,e.visitor,t)}else c.error("".concat(u," -     * No cookie name was resolved for the cookie type. Unable to set visitor tracking cookie."),{e:e,args:t,type:i})})),c.debug("".concat(u," -   END: iterating visitor cookie types."),{visitorCookieTypes:h}));var m=null!==(o=null==a?void 0:a.visit)&&void 0!==o?o:[];0==m.length?c.debug("".concat(u," -   * No visit cookie types were specified in the cookie settings, so no visit tracking cookies will be updated."),{e:e,args:t}):(c.debug("".concat(u," -   START: iterating visit cookie types."),{visitCookieTypes:m}),m.forEach((function(i){var n=l(i);if(n){var o=p(i,e.visitor,c,u);c.debug("".concat(u," -     * Cookie value retrieved from visit."),{cookieValue:o,cookieType:i}),o&&!o.unsupportedCookieType&&s(r.Visit,o.value,n,e.visitor,t)}else c.error("".concat(u," -     * No cookie name was resolved for the cookie type. Unable to set visit tracking cookie."),{e:e,args:t,type:i})})),c.debug("".concat(u," -   END: iterating visit cookie types."),{visitorCookieTypes:h})),c.debug("".concat(u," - END: tracking event handler to set tracking cookies."),{type:e.type,e:e,args:t})}function s(e,t,i,r,n){var a=n.logger,s=n.loggerPrefix,c=n.removeCookie,u=n.setCookie,d=(0,o.getCookie)(i);t?d!=t&&(a.debug("".concat(s," - Updating the ").concat(e," tracking cookie."),{cookie:i,newValue:t,currentValue:d,visitor:r}),u(i,t,{expires:(0,o.getMaxExpirationDate)(),path:"/"})):d&&(a.debug("".concat(s," - Removing the ").concat(e," tracking cookie."),{cookie:i,currentValue:d,visitor:r}),c(i))}i.getTrackerCookieSettings=function(e){var t,i,r,n;return{visit:null===(i=null===(t=null==e?void 0:e.settings)||void 0===t?void 0:t.cookies)||void 0===i?void 0:i.visit,visitor:null===(n=null===(r=null==e?void 0:e.settings)||void 0===r?void 0:r.cookies)||void 0===n?void 0:n.visitor}},i.addSubscriptionsForTrackerCookies=function(e,t){var i,r,o=t.logger,s=t.loggerPrefix;o.debug("".concat(s," - START: adding subscriptions for tracker cookies."),{manager:e.id});var c=t.cookieSettings,u=null!==(i=null==c?void 0:c.visit)&&void 0!==i?i:[],d=null!==(r=null==c?void 0:c.visitor)&&void 0!==r?r:[];0==u.length&&0==d.length?o.debug("".concat(s," -   * No tracker cookies are specified to be set, so there are no subscriptions to add.")):(o.debug("".concat(s," -   * Adding subscription for tracking event."),{manager:e.id,event:"visit-created"}),e.subscribe("visit-created",(function(e){!function(e,t){var i,r=t.cookieSettings,o=t.logger,a=t.loggerPrefix;if(o.debug("".concat(a," - START: tracking event handler to remove visit tracking cookies."),{type:e.type,e:e,args:t}),e.visitor){var s=null!==(i=null==r?void 0:r.visit)&&void 0!==i?i:[];0==s.length?o.debug("".concat(a," -   * No visit cookie types were specified in the cookie settings, so no visit tracking cookies will be removed."),{e:e,args:t}):(o.debug("".concat(a," -   START: removing cookies."),{e:e,args:t,visitCookieTypes:s}),s.forEach((function(e){!function(e,t){var i=t.logger,r=t.loggerPrefix,o=t.getCookie,a=t.removeCookie,s=t.getCookieName,c=(void 0===s?n.defaultGetCookieName:s)(e);if(!c)return void i.error("".concat(r," -     * No cookie name was resolved for the specified cookie type, so no visit tracking cookie will be removed."),{type:e});var u=o(c);if(!u)return;i.debug("".concat(r," -     * Removing existing visit tracking cookie."),{type:e,cookie:c,value:u}),a(c)}(e,t)})),o.debug("".concat(a," -   END: removing cookies."),{e:e,args:t,visitCookieTypes:s}))}else o.error("".concat(a," -   * No visitor is set on the tracking event. Unable to remove visit tracking cookies."),{e:e,args:t});o.debug("".concat(a," - END: tracking event handler to remove visit tracking cookies."),{type:e.type,e:e,args:t})}(e,t)})),o.debug("".concat(s," -   * Adding subscription for tracking event."),{manager:e.id,event:"visit-updated"}),e.subscribe("visit-updated",(function(e){a(e,t)})),o.debug("".concat(s," -   * Adding subscription for tracking event."),{manager:e.id,event:"visitor-updated"}),e.subscribe("visitor-updated",(function(e){a(e,t)}))),o.debug("".concat(s," - END: adding subscriptions for tracker cookies."),{manager:e.id})},function(e){e.Visitor="visitor",e.Visit="visit"}(r||(r={}))},{"../connectors/sitecore/cookies":121,"../cookies":133}],158:[function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};i.__esModule=!0,i.getNullTracker=i.getDefaultTracker=void 0,n(e("./tracker"),i);var o=e("./getTracker");r(i,o,"getDefaultTracker");var a=e("./nullTracker");r(i,a,"getNullTracker"),n(e("./handleDestinations"),i),n(e("./handleTrackerEvents"),i),n(e("./global"),i),n(e("./ga"),i),n(e("./ga4"),i),n(e("./oracleDmp"),i),n(e("./xdb"),i)},{"./ga":152,"./ga4":153,"./getTracker":154,"./global":155,"./handleDestinations":156,"./handleTrackerEvents":157,"./nullTracker":159,"./oracleDmp":160,"./tracker":161,"./xdb":163}],159:[function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var i,r,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};i.__esModule=!0,i.getNullTracker=void 0;var o=e("../models/trackedActivity"),a=e("@uniformdev/optimize-common-sitecore"),s={id:"TRACKER_NULL",event:function(e,t,i){return r(this,void 0,void 0,(function(){return n(this,(function(e){return[2,new o.TrackedActivityResults]}))}))},initialize:function(e){return r(this,void 0,void 0,(function(){return n(this,(function(e){return[2,new o.TrackedActivityResults]}))}))},track:function(e,t,i){return r(this,void 0,void 0,(function(){return n(this,(function(e){return[2,new o.TrackedActivityResults]}))}))},subscribe:function(e,t){return(0,a.createUniformUnsubscribe)((function(){return!1}))},contextReaders:new Map,state:"ready"};i.getNullTracker=function(){return s}},{"../models/trackedActivity":140,"@uniformdev/optimize-common-sitecore":94}],160:[function(e,t,i){"use strict";i.__esModule=!0,i.getDispatchersForOracleDmpDestinations=void 0;var r=e("../connectors/oracleDmp/dispatcher"),n=e("../connectors/sitecore/oracleDmpEventConverter"),o=e("../cookies");i.getDispatchersForOracleDmpDestinations=function(e,t){var i=t.logger,a=t.loggerPrefix,s=[];return e.forEach((function(e){var c=function(e,t){if(!e)return;var i=t.oracleDmp,a=t.logger,s=t.loggerPrefix,c=null==i?void 0:i.initializeOracleDmp;if(!(c?c(e,a):function(e,t){var i=t.logger,n=t.loggerPrefix;if(!window)return i.error("".concat(n," - Cannot initialize Oracle DMP dispatcher when window is undefined."),e),!1;return e.containerIds.forEach((function(a){var s=(0,r.getOracleDmpCallbackName)(a);if(s){var c=function(r){var a;if(e.dataHandling){var s=!1;if((null==r?void 0:r.campaigns)&&function(e,t,i){var r=t.dataHandling;if(!r)return!1;var n=!1;return["campaigns","audiences"].forEach((function(a){var s=r[a];s&&function(e,t,i,r,n){var a=n.logger,s=n.loggerPrefix;if(!(null==r?void 0:r.dataHandling))return!1;if(!Array.isArray(t))return a.debug("".concat(s," - Oracle DMP ").concat(e," are expected to be an array."),t),!1;var c=null==r?void 0:r.dataHandling[e];if(!c)return a.debug("".concat(s," - Oracle DMP destination is not configured to handle ").concat(e," data."),{destination:r,data:t}),!1;switch(c.type){case"cookie":return function(e,t,i,r,n,a){var s=a.logger,c=a.loggerPrefix,u=a.getCookie,d=a.removeCookie,l=a.setCookie;if(!e)return s.debug("".concat(c," - Oracle DMP destination is configured to save ").concat(t," to a cookie, but the cookie name is not specified. Data will not be saved."),{destination:n,data:i}),!1;var f=[];i.forEach((function(e){var t=r(e);t&&-1==f.indexOf(t)&&f.push(t)}));var v=u(e);if(!v&&0==f.length)return s.debug("".concat(c," - No ").concat(t," were returned from Oracle DMP and no values are currently set in the cookie, so data handling is complete."),{cookie:e,data:i}),!1;if(0==f.length)return s.debug("".concat(c," - No ").concat(t," were returned from Oracle DMP so the cookie will be deleted."),{cookie:e,data:i}),d(e),!0;var g=f.sort().join(",");if(g==v)return!1;s.debug("".concat(c," - Data for ").concat(t," from Oracle DMP will be set on the cookie."),{cookie:e,values:f});var p=(0,o.getMaxExpirationDate)();return l(e,g,{expires:p,path:"/"}),!0}(c.data,e,t,i,r,n);default:return a.debug("".concat(s," - Unsupported type specified for handling ").concat(e," data from Oracle DMP."),{type:c.type,data:t}),!1}}(a,e,(function(e){return e[s.property]}),t,i)&&(n=!0)})),n}(r.campaigns,e,t)&&(s=!0),s){var c=null===(a=null===window||void 0===window?void 0:window.uniform)||void 0===a?void 0:a.subscriptions;if(!c)return void i.info("".concat(n," - Unable to get a reference to the Uniform global subscription manager from the window, so unable to publish event to notify subscribers that Oracle DMP data was handled."),{data:r,destination:e});if(!e.triggerName)return void i.info("".concat(n," - No trigger name is specified on the Oracle DMP destination, so unable to publish event to notify subscribers that Oracle DMP data was handled."),{manager:c.id,data:r,destination:e});i.info("".concat(n," - Publishing event to notify subscribers that Oracle DMP data was handled."),{manager:c.id,data:r,destination:e}),c.publish({type:e.triggerName,when:new Date})}}else i.info("".concat(n," - No data handling settings were specified on the Oracle DMP destination, so the callback data will not be handled."),{data:r,destination:e})};Object.defineProperty(window,s,{get:function(){return c}})}else i.error("".concat(n," - Cannot initialize Oracle DMP dispatcher for container because callback name could not be determined."),{containerId:a})})),!0}(e,t)))return void a.debug("".concat(s," - Unable to initialize Oracle DMP so no Oracle DMP dispatch will be performed."),e);var u=function(e,t){var i,r=t.logger,o=t.loggerPrefix,a=null!==(i=e.activityConverters)&&void 0!==i?i:[];if(1!=e.doNotUseDefaultActivityConverter){var s=(0,n.getOracleDmpTrackedActivityConverterForSitecore)();s&&a.every((function(e){return e.type!=s.type}))&&(a.push(s),r.debug("".concat(o," - Added default GA tracked activity converter for Sitecore."),{converters:a}))}return a}(e,t);return new r.OracleDmpDispatcher(u,e)}(e,t);c?s.push(c):i.error("".concat(a," - Unable to get dispatcher for Oracle DMP destination."),e)})),s}},{"../connectors/oracleDmp/dispatcher":118,"../connectors/sitecore/oracleDmpEventConverter":126,"../cookies":133}],161:[function(e,t,i){"use strict";i.__esModule=!0,i.UniformCookieNames=void 0,function(e){e.Testing="UNIFORM_TRACKER_testing",e.VisitId="UNIFORM_TRACKER_visit_id",e.VisitorId="UNIFORM_TRACKER_visitor_id",e.VisitCount="UNIFORM_TRACKER_visit_count",e.VisitState="UNIFORM_TRACKER_visit_state"}(i.UniformCookieNames||(i.UniformCookieNames={}))},{}],162:[function(e,t,i){"use strict";i.__esModule=!0,i.getVisitorChanges=i.getVisitChangesFromVisits=i.getVisitChangesFromResults=void 0,i.getVisitChangesFromResults=function(e,t,i){var r,n,o,a=[];((null===(r=null==e?void 0:e.visitActivities)||void 0===r?void 0:r.length)>0||(null===(n=null==e?void 0:e.visitUpdates)||void 0===n?void 0:n.length)>0)&&a.push("activities"),(null===(o=null==e?void 0:e.visitUpdates)||void 0===o?void 0:o.length)>0&&e.visitUpdates.forEach((function(e){a.includes(e.type)||a.push(e.type)}));var s=new Map;return s.set(t.id,a),s},i.getVisitChangesFromVisits=function(e,t){var i=new Map;return null==e||e.forEach((function(e){if(null==e?void 0:e.data){var t=[];Array.isArray(e.data.activities)&&e.data.activities.forEach((function(e){(null==e?void 0:e.type)&&-1==t.indexOf(e.type)&&t.push(e.type)})),e.data.campaign&&t.push("campaign"),i.set(e.id,t)}})),i},i.getVisitorChanges=function(e,t,i){var r,n=[];return(null===(r=null==e?void 0:e.visitorUpdates)||void 0===r?void 0:r.length)>0&&e.visitorUpdates.forEach((function(e){n.includes(e.type)||n.push(e.type)})),n}},{}],163:[function(e,t,i){"use strict";i.__esModule=!0,i.getDispatchersForXdbDestinations=void 0;var r=e("../connectors/sitecore/dispatcher");i.getDispatchersForXdbDestinations=function(e,t){var i=t.logger,n=t.loggerPrefix,o=[];return e.forEach((function(e){var t=function(e,t){if(!e)return;return new r.XdbDispatcher(e)}(e);t?o.push(t):i.error(n+" - Unable to get dispatcher for xDB destination.",e)})),o}},{"../connectors/sitecore/dispatcher":123}]},{},[106])(106)}));